Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 6B69124A4C3
	for <lists+linux-kernel@lfdr.de>; Wed, 19 Aug 2020 19:18:39 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726738AbgHSRSd (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Wed, 19 Aug 2020 13:18:33 -0400
Received: from mx2.suse.de ([195.135.220.15]:40168 "EHLO mx2.suse.de"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1726466AbgHSRSc (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
        Wed, 19 Aug 2020 13:18:32 -0400
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.221.27])
        by mx2.suse.de (Postfix) with ESMTP id BE2ABAD8D;
        Wed, 19 Aug 2020 17:18:57 +0000 (UTC)
Date:   Wed, 19 Aug 2020 19:18:30 +0200
Message-ID: <s5h364ih7vd.wl-tiwai@suse.de>
From:   Takashi Iwai <tiwai@suse.de>
To:     penghao <penghao@uniontech.com>
Cc:     Mark Pearson <mpearson@lenovo.com>,
        Hui Wang <hui.wang@canonical.com>,
        Kai-Heng Feng <kai.heng.feng@canonical.com>, perex@perex.cz,
        alexander@tsoy.me, dan.carpenter@oracle.com, crwulff@gmail.com,
        gustavoars@kernel.org, alsa-devel@alsa-project.org,
        linux-kernel@vger.kernel.org
Subject: Re: [PATCH] ALSA: usb-audio: Add prevent wakeup from s3 state trig by Lenovo ThinkCentre TI024Gen3 USB-audio
In-Reply-To: <20200819115757.23168-1-penghao@uniontech.com>
References: <20200819115757.23168-1-penghao@uniontech.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

[ Adding a few more relevant people to Cc. ]

On Wed, 19 Aug 2020 13:57:57 +0200,
penghao wrote:
> 
> TI024Gen3 USB-audio is controlled by TI024Gen3,when TI024Gens
> enter sleep mode, USB-audio will disconnect from USB bus port,
> wakup form s3 state
> 
> Signed-off-by: penghao <penghao@uniontech.com>
> ---
>  sound/usb/card.c | 6 ++++++
>  1 file changed, 6 insertions(+)
> 
> diff --git a/sound/usb/card.c b/sound/usb/card.c
> index 696e788c5d31..6bdbb34009b3 100644
> --- a/sound/usb/card.c
> +++ b/sound/usb/card.c
> @@ -658,6 +658,12 @@ static int usb_audio_probe(struct usb_interface *intf,
>  	}
>  
>  	dev_set_drvdata(&dev->dev, chip);
> +	/*
> +	 *ALSA: usb-audio: Add prevent wakeup from s3 state trig by Lenovo
> +	 *ThinkCentre TI024Gen3 usb-audio
> +	 */
> +	if ((usb_id->idVendor == 0x17ef) && (usb_id->idProduct == 0xa012))
> +		device_set_wakeup_enable(ï¼†dev->dev, 0);

Here it's no proper ASCII letter, and this must be broken.
Please check the actual patch before submitting.

In anyway, before going further, I'd like to hear from other people
whether this is really mandatory and appropriate.  And whether it's
specific to that device, too (not other Lenovo devices?)


thanks,

Takashi
