Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id A767527FB5E
	for <lists+linux-kernel@lfdr.de>; Thu,  1 Oct 2020 10:18:36 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1731383AbgJAISf (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Thu, 1 Oct 2020 04:18:35 -0400
Received: from esa3.microchip.iphmx.com ([68.232.153.233]:34609 "EHLO
        esa3.microchip.iphmx.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1725878AbgJAISe (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Thu, 1 Oct 2020 04:18:34 -0400
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=microchip.com; i=@microchip.com; q=dns/txt; s=mchp;
  t=1601540313; x=1633076313;
  h=from:to:cc:subject:date:message-id:references:
   in-reply-to:content-id:content-transfer-encoding:
   mime-version;
  bh=ykpd+a2KNjWB+zQid/7+9iaa62ralgh+DlQIbyXPz/0=;
  b=usOhNaZbrERtAxfJfJB8nPPI1X1Cufz01+/mcvCADaEAJf2bjX5dh8eK
   4lDxcX6R45rELWRLcnD1/wy1UfNPe2Np+7CiPG8sLPr1iGlTIrrI2jaHn
   NUP54hDWJLKBPmPxyAye4B6COpHkMfbMnuTqGUUeaai4+hPH4KTtRazUI
   vQ/mthVineIxyFNEjNy8JlQnrNhCsq6U/bQjarRHXL+MVH5kp5mW/F+Pj
   Q+aPHKPuAdSA7ZMi7/OfKZqs+k39AtOgsUNbGzSzW7h1G98iHFymammL7
   1iG6VQAZnNSxDKQ/N0fdyYfvh5n+j5fkWlDXCQ+xMEEUGGOfgRn7/e6wR
   w==;
IronPort-SDR: Uu2pTq4m+iq/XvtB+EuWvQXhYEeg4lpCI8t6nSebA803y9QtXRnLSrDwRZh//AflTNoC6oaKRa
 Dh9QoFRSQDHF+q+IWuNzEjX5rellRqgTTZXyYB2rg40Zz+U7poXNvHE+EOCH3G6MfwzyzbJJkh
 6SvNwVuT+S9LeuL0TGI5zqcpKasDsj1wZ3XCrPfXu0EpFtx1ebrl2YSPN+z8KrOjjbmtrvVbD/
 wLLnA6QEMiBR+SKDNjkOg3B281REudF1d2bitKOTE9cE73g228ye4C3JiCA/amjjLARfH3zJ/T
 2y4=
X-IronPort-AV: E=Sophos;i="5.77,323,1596524400"; 
   d="scan'208";a="93854116"
Received: from smtpout.microchip.com (HELO email.microchip.com) ([198.175.253.82])
  by esa3.microchip.iphmx.com with ESMTP/TLS/AES256-SHA256; 01 Oct 2020 01:18:33 -0700
Received: from chn-vm-ex04.mchp-main.com (10.10.85.152) by
 chn-vm-ex04.mchp-main.com (10.10.85.152) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.1979.3; Thu, 1 Oct 2020 01:18:32 -0700
Received: from NAM11-CO1-obe.outbound.protection.outlook.com (10.10.215.89) by
 email.microchip.com (10.10.87.151) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id 15.1.1979.3
 via Frontend Transport; Thu, 1 Oct 2020 01:18:32 -0700
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=C+cM6c1fuKFKAOjZ3J8UTmsC0AM1hwYjRph8soI3+d1q9lgu5/yFegFBay5yYhA2aw+CpUrd6gVzn4mJyvR+wkrQRjbxVVptMvjOKdWi502hGRj03qzAk9EFgQI30HNFQ2xi93/OkwoK5voKRJnRHp9De5qMYwlZURqOYGyMVonVGzViJ6ZuWQHKSJ+rBQ0l4JW3tzWuxasiY3HYt+k1dt8WpvbWxXu6Z5ISRDjrT4+bF+nDxOcgpY+lV6FeUh0q5aZXCloThclG9FvXwwdIm7S3BBXaVaNpxVGgz+MH0HffmpRz4JCygoZQs6yrSS4AmaKMZq058lxG/GYR1HS3dA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=ykpd+a2KNjWB+zQid/7+9iaa62ralgh+DlQIbyXPz/0=;
 b=Umy1Kmo4mWGgr47nVYMZEEZOXHi95NXAtDxMVxFryWAf23qqfEwlkOI7s0a6RbOSBUQUHWbSLgVApQk+Kg8xgwEiej1bvTOMBOmwdYbhCrLkQC0A+hlTzDfqYVQ/dJgNH9ByclU7pVY08mv3OnugRlLlJaLRPFJuHz5U1oFRWpmPT8I6z6os9Fk1c6M7G0yZbKGxJsSN5hZIeU0P2yL9iTNiZUB37vchYQ9bawG6J/yUEK4INwzXNTlR/I+QGsr0O+fXS3VSdPTwy/rMAmmZK8dMAOEkWg1/BwBg0FsN5Xb2l1+hw7HehUXriL41YMvBIyHw8MzzfbPiJGCpC3bbGg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=microchip.com; dmarc=pass action=none
 header.from=microchip.com; dkim=pass header.d=microchip.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=microchiptechnology.onmicrosoft.com;
 s=selector2-microchiptechnology-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=ykpd+a2KNjWB+zQid/7+9iaa62ralgh+DlQIbyXPz/0=;
 b=pxfetNRSys8bjqY0sredHEfL0NzZpW9Puh3w0j2wxLltUJuZ/6OvYYO/rkGoOKMzMqXIWuv9SFphSLd4TcsJ+92RNYH/hm3e/iv+XY6IGZOjlhWHohsIvl9n45IeFw4/keXilcLn2sjh4V49pXCKmHJRNuHxRqc2BGCCGVTikp4=
Received: from DM5PR11MB1914.namprd11.prod.outlook.com (2603:10b6:3:112::12)
 by DM6PR11MB4284.namprd11.prod.outlook.com (2603:10b6:5:205::28) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3433.35; Thu, 1 Oct
 2020 07:46:30 +0000
Received: from DM5PR11MB1914.namprd11.prod.outlook.com
 ([fe80::f44a:f58e:c13b:947a]) by DM5PR11MB1914.namprd11.prod.outlook.com
 ([fe80::f44a:f58e:c13b:947a%4]) with mapi id 15.20.3433.032; Thu, 1 Oct 2020
 07:46:30 +0000
From:   <Tudor.Ambarus@microchip.com>
To:     <p.yadav@ti.com>, <miquel.raynal@bootlin.com>, <richard@nod.at>,
        <vigneshr@ti.com>, <linux-mtd@lists.infradead.org>,
        <linux-kernel@vger.kernel.org>
CC:     <nsekhar@ti.com>, <boris.brezillon@collabora.com>
Subject: Re: [PATCH v14 03/15] mtd: spi-nor: add support for DTR protocol
Thread-Topic: [PATCH v14 03/15] mtd: spi-nor: add support for DTR protocol
Thread-Index: AQHWl8b18X9JWcT5zkKq1MM32MT8Tg==
Date:   Thu, 1 Oct 2020 07:46:30 +0000
Message-ID: <67f14906-ef28-ff4c-b41f-3500c9212ad7@microchip.com>
References: <20200930185732.6201-1-p.yadav@ti.com>
 <20200930185732.6201-4-p.yadav@ti.com>
In-Reply-To: <20200930185732.6201-4-p.yadav@ti.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
user-agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.10.0
authentication-results: ti.com; dkim=none (message not signed)
 header.d=none;ti.com; dmarc=none action=none header.from=microchip.com;
x-originating-ip: [5.13.51.157]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: e7252225-b25a-43db-c0fd-08d865de1c8b
x-ms-traffictypediagnostic: DM6PR11MB4284:
x-microsoft-antispam-prvs: <DM6PR11MB42844FA85908F8A1FC37D65BF0300@DM6PR11MB4284.namprd11.prod.outlook.com>
x-bypassexternaltag: True
x-ms-oob-tlc-oobclassifiers: OLM:8882;
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: TQuK/ebNRA0Un8wQrmwrfSzG1nyWJ/7rjIR2FiRRpw6U6cI+ZNrvWY2YqWZMb2exttyFdtc1Y8lOk3YLmwQ+ZGxFulP8U52YDrvjKPgSIz3KNkM8BJMXVv6ROsdl8s3wTI/nF8Q6QQ//ysyW8LESwP/Nq65K3VN6L6ksfvThDa9kMTjWRY5xWEsVCE2OYGn/yOIQkeNkGBT6Q8pyW5GAz9iDhLQ+rmdm+K3Nrdlx0PL3yMgvD6SbxtxetRe5bWkAgwFNXVub02nETmRu/FiY8BW17JUPEvtxizA9H2X38L5v7rk9M6wog5E5vMzKqlpmNhTfp2Cqx3FTItZbkI02bm92M22f70BYEYXzMioGE/yTAGf2gvxcT2PQyNoWJS0yvrlYB3fk8hUeYAiHsFMOGPSUPlslsb2VY7HtPBtX+VJEMq1B2eP/a7+UBxWaVKH3
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:DM5PR11MB1914.namprd11.prod.outlook.com;PTR:;CAT:NONE;SFS:(376002)(366004)(346002)(396003)(136003)(39860400002)(110136005)(66446008)(66476007)(54906003)(66556008)(91956017)(76116006)(66946007)(2906002)(64756008)(4326008)(8936002)(71200400001)(316002)(8676002)(36756003)(6486002)(86362001)(53546011)(6506007)(83380400001)(31696002)(30864003)(6512007)(5660300002)(31686004)(186003)(2616005)(478600001)(26005)(334744003)(43740500002)(579004)(559001)(352734003);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata: A4M/eEgJFoY/lXX5C1breCdZ6jSDYWPQnkb0cZIPwmnm7ZLEOzAhyFwSIrpplcR4Vyp6bmAMM5c3Ic5MlCU4/K5vsHDu3JCPtRkIQ4bkXZ5vD45aHESyZMTI9R/KRxSd8lzkz48rJojP/QR0n/zTGaLO7eaIqeCB9ZtUFyuEXKz2oqm6So9nJeWbPNYuqvJ5GJgP/jIzybiOxHPTXLRwzkVAKzG5MfqsfwxDGfjHitVIWQBhBQ/U63RPevrAsAS5WuGGWag+zf5dfQjRHaLgZ2LGjpH9fNtz6s+caTmzX3n+SNA/3reLOwCye7N1QZ0YNHIJ2z9e7z17KCDJqW8+3NVZQMRg/1+YPygj3efIhP7rVUtbwPaxhdQ4Jf3LLIow9b4UqGizzEKP2IGggboqMyH1FV9C8taHZZ/Mlc8N/XHmJUgdHG3OlFcGXExcqIjNWyYJ0o8ZsZqW+x/p0K/aNZ2gz7TjI6KeBrjReZ+J78ojr27Sq5zKRNjEm1labTVrkWRugAlRVCKOg2eFCFL/5x6xh+lojtgFFKBGNYJxn2xkXkuJLtwnfnUqZZKWy6gIXaaz1P+H4ZMMWe4fZRlTktwzTvxvGc9Hvq0kORBs0adgE5ps1ioQG1p07+cB2af8HS1SHPGUa1BeGmgQDcUklQ==
x-ms-exchange-transport-forked: True
Content-Type: text/plain; charset="utf-8"
Content-ID: <2B17410AD423AB44A63ED0C691BCDC8E@namprd11.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: DM5PR11MB1914.namprd11.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: e7252225-b25a-43db-c0fd-08d865de1c8b
X-MS-Exchange-CrossTenant-originalarrivaltime: 01 Oct 2020 07:46:30.8201
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3f4057f3-b418-4d4e-ba84-d55b4e897d88
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: SMcqbcUc9LNhEwHPQs7NYsg796cxTlDOapC2H//H549/7BpezSgpBOUZk5cs7UzNYeXIbeY1lUIOGB8KVCp+FAnjVElYPYF/yGsK6Lm/o/A=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM6PR11MB4284
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

T24gOS8zMC8yMCA5OjU3IFBNLCBQcmF0eXVzaCBZYWRhdiB3cm90ZToNCj4gRVhURVJOQUwgRU1B
SUw6IERvIG5vdCBjbGljayBsaW5rcyBvciBvcGVuIGF0dGFjaG1lbnRzIHVubGVzcyB5b3Uga25v
dyB0aGUgY29udGVudCBpcyBzYWZlDQo+IA0KPiBEb3VibGUgVHJhbnNmZXIgUmF0ZSAoRFRSKSBp
cyBTUEkgcHJvdG9jb2wgaW4gd2hpY2ggZGF0YSBpcyB0cmFuc2ZlcnJlZA0KPiBvbiBlYWNoIGNs
b2NrIGVkZ2UgYXMgb3Bwb3NlZCB0byBvbiBlYWNoIGNsb2NrIGN5Y2xlLiBNYWtlDQo+IGZyYW1l
d29yay1sZXZlbCBjaGFuZ2VzIHRvIGFsbG93IHN1cHBvcnRpbmcgZmxhc2hlcyBpbiBEVFIgbW9k
ZS4NCj4gDQo+IFJpZ2h0IG5vdywgbWl4ZWQgRFRSIG1vZGVzIGFyZSBub3Qgc3VwcG9ydGVkLiBT
bywgZm9yIGV4YW1wbGUgYSBtb2RlDQo+IGxpa2UgNFMtNEQtNEQgd2lsbCBub3Qgd29yay4gQWxs
IHBoYXNlcyBuZWVkIHRvIGJlIGVpdGhlciBEVFIgb3IgU1RSLg0KPiANCj4gVGhlIHhTUEkgc3Bl
YyBzYXlzIHRoYXQgIlRoZSBwcm9ncmFtIGNvbW1hbmRzIHByb3ZpZGUgU1BJIGJhY2t3YXJkDQo+
IGNvbXBhdGlibGUgY29tbWFuZHMgZm9yIHByb2dyYW1taW5nIGRhdGEuLi4iLiBTbyA4RC04RC04
RCBwYWdlIHByb2dyYW0NCj4gb3Bjb2RlcyBhcmUgcG9wdWxhdGVkIHdpdGggdXNpbmcgMVMtMVMt
MVMgb3Bjb2Rlcy4NCj4gDQo+IFNpZ25lZC1vZmYtYnk6IFByYXR5dXNoIFlhZGF2IDxwLnlhZGF2
QHRpLmNvbT4NCj4gLS0tDQo+ICBkcml2ZXJzL210ZC9zcGktbm9yL2NvcmUuYyAgfCAzMjEgKysr
KysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tDQo+ICBkcml2ZXJzL210ZC9zcGktbm9y
L2NvcmUuaCAgfCAgIDcgKw0KPiAgZHJpdmVycy9tdGQvc3BpLW5vci9zZmRwLmMgIHwgICA5ICst
DQo+ICBpbmNsdWRlL2xpbnV4L210ZC9zcGktbm9yLmggfCAgNTEgKysrKy0tDQo+ICA0IGZpbGVz
IGNoYW5nZWQsIDI5MSBpbnNlcnRpb25zKCspLCA5NyBkZWxldGlvbnMoLSkNCj4gDQo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL210ZC9zcGktbm9yL2NvcmUuYyBiL2RyaXZlcnMvbXRkL3NwaS1ub3Iv
Y29yZS5jDQo+IGluZGV4IDdhM2JmNDYwYTJmYS4uYmViMTc2MzlkYzkyIDEwMDY0NA0KPiAtLS0g
YS9kcml2ZXJzL210ZC9zcGktbm9yL2NvcmUuYw0KPiArKysgYi9kcml2ZXJzL210ZC9zcGktbm9y
L2NvcmUuYw0KPiBAQCAtNDAsNiArNDAsNzggQEANCj4gDQo+ICAjZGVmaW5lIFNQSV9OT1JfTUFY
X0FERFJfV0lEVEggNA0KPiANCj4gKy8qKg0KPiArICogc3BpX25vcl9nZXRfY21kX2V4dCgpIC0g
R2V0IHRoZSBjb21tYW5kIG9wY29kZSBleHRlbnNpb24gYmFzZWQgb24gdGhlDQo+ICsgKiAgICAg
ICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvbiB0eXBlLg0KPiArICogQG5vcjogICAgICAgICAg
ICAgICBwb2ludGVyIHRvIGEgJ3N0cnVjdCBzcGlfbm9yJw0KPiArICogQG9wOiAgICAgICAgICAg
ICAgICAgICAgICAgIHBvaW50ZXIgdG8gdGhlICdzdHJ1Y3Qgc3BpX21lbV9vcCcgd2hvc2UgcHJv
cGVydGllcw0KPiArICogICAgICAgICAgICAgICAgICAgICBuZWVkIHRvIGJlIGluaXRpYWxpemVk
Lg0KPiArICoNCj4gKyAqIFJpZ2h0IG5vdywgb25seSAicmVwZWF0IiBhbmQgImludmVydCIgYXJl
IHN1cHBvcnRlZC4NCj4gKyAqDQo+ICsgKiBSZXR1cm46IFRoZSBvcGNvZGUgZXh0ZW5zaW9uLg0K
PiArICovDQo+ICtzdGF0aWMgdTggc3BpX25vcl9nZXRfY21kX2V4dChjb25zdCBzdHJ1Y3Qgc3Bp
X25vciAqbm9yLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qg
c3BpX21lbV9vcCAqb3ApDQo+ICt7DQo+ICsgICAgICAgc3dpdGNoIChub3ItPmNtZF9leHRfdHlw
ZSkgew0KPiArICAgICAgIGNhc2UgU1BJX05PUl9FWFRfSU5WRVJUOg0KPiArICAgICAgICAgICAg
ICAgcmV0dXJuIH5vcC0+Y21kLm9wY29kZTsNCj4gKw0KPiArICAgICAgIGNhc2UgU1BJX05PUl9F
WFRfUkVQRUFUOg0KPiArICAgICAgICAgICAgICAgcmV0dXJuIG9wLT5jbWQub3Bjb2RlOw0KPiAr
DQo+ICsgICAgICAgZGVmYXVsdDoNCj4gKyAgICAgICAgICAgICAgIGRldl9lcnIobm9yLT5kZXYs
ICJVbmtub3duIGNvbW1hbmQgZXh0ZW5zaW9uIHR5cGVcbiIpOw0KPiArICAgICAgICAgICAgICAg
cmV0dXJuIDA7DQo+ICsgICAgICAgfQ0KPiArfQ0KPiArDQo+ICsvKioNCj4gKyAqIHNwaV9ub3Jf
c3BpbWVtX3NldHVwX29wKCkgLSBTZXQgdXAgY29tbW9uIHByb3BlcnRpZXMgb2YgYSBzcGktbWVt
IG9wLg0KPiArICogQG5vcjogICAgICAgICAgICAgICBwb2ludGVyIHRvIGEgJ3N0cnVjdCBzcGlf
bm9yJw0KPiArICogQG9wOiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXIgdG8gdGhlICdz
dHJ1Y3Qgc3BpX21lbV9vcCcgd2hvc2UgcHJvcGVydGllcw0KPiArICogICAgICAgICAgICAgICAg
ICAgICBuZWVkIHRvIGJlIGluaXRpYWxpemVkLg0KPiArICogQHByb3RvOiAgICAgICAgICAgICB0
aGUgcHJvdG9jb2wgZnJvbSB3aGljaCB0aGUgcHJvcGVydGllcyBuZWVkIHRvIGJlIHNldC4NCj4g
KyAqLw0KPiArdm9pZCBzcGlfbm9yX3NwaW1lbV9zZXR1cF9vcChjb25zdCBzdHJ1Y3Qgc3BpX25v
ciAqbm9yLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzcGlfbWVtX29w
ICpvcCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbnVtIHNwaV9ub3Jf
cHJvdG9jb2wgcHJvdG8pDQo+ICt7DQo+ICsgICAgICAgdTggZXh0Ow0KPiArDQo+ICsgICAgICAg
b3AtPmNtZC5idXN3aWR0aCA9IHNwaV9ub3JfZ2V0X3Byb3RvY29sX2luc3RfbmJpdHMocHJvdG8p
Ow0KPiArDQo+ICsgICAgICAgaWYgKG9wLT5hZGRyLm5ieXRlcykNCj4gKyAgICAgICAgICAgICAg
IG9wLT5hZGRyLmJ1c3dpZHRoID0gc3BpX25vcl9nZXRfcHJvdG9jb2xfYWRkcl9uYml0cyhwcm90
byk7DQo+ICsNCj4gKyAgICAgICBpZiAob3AtPmR1bW15Lm5ieXRlcykNCj4gKyAgICAgICAgICAg
ICAgIG9wLT5kdW1teS5idXN3aWR0aCA9IHNwaV9ub3JfZ2V0X3Byb3RvY29sX2FkZHJfbmJpdHMo
cHJvdG8pOw0KPiArDQo+ICsgICAgICAgaWYgKG9wLT5kYXRhLm5ieXRlcykNCj4gKyAgICAgICAg
ICAgICAgIG9wLT5kYXRhLmJ1c3dpZHRoID0gc3BpX25vcl9nZXRfcHJvdG9jb2xfZGF0YV9uYml0
cyhwcm90byk7DQo+ICsNCj4gKyAgICAgICBpZiAoc3BpX25vcl9wcm90b2NvbF9pc19kdHIocHJv
dG8pKSB7DQo+ICsgICAgICAgICAgICAgICAvKg0KPiArICAgICAgICAgICAgICAgICogU1BJTUVN
IHN1cHBvcnRzIG1peGVkIERUUiBtb2RlcywgYnV0IHJpZ2h0IG5vdyB3ZSBjYW4gb25seQ0KPiAr
ICAgICAgICAgICAgICAgICogaGF2ZSBhbGwgcGhhc2VzIGVpdGhlciBEVFIgb3IgU1RSLiBJT1cs
IFNQSU1FTSBjYW4gaGF2ZQ0KPiArICAgICAgICAgICAgICAgICogc29tZXRoaW5nIGxpa2UgNFMt
NEQtNEQsIGJ1dCBTUEkgTk9SIGNhbid0LiBTbywgc2V0IGFsbCA0DQo+ICsgICAgICAgICAgICAg
ICAgKiBwaGFzZXMgdG8gZWl0aGVyIERUUiBvciBTVFIuDQo+ICsgICAgICAgICAgICAgICAgKi8N
Cj4gKyAgICAgICAgICAgICAgIG9wLT5jbWQuZHRyID0gdHJ1ZTsNCj4gKyAgICAgICAgICAgICAg
IG9wLT5hZGRyLmR0ciA9IHRydWU7DQo+ICsgICAgICAgICAgICAgICBvcC0+ZHVtbXkuZHRyID0g
dHJ1ZTsNCj4gKyAgICAgICAgICAgICAgIG9wLT5kYXRhLmR0ciA9IHRydWU7DQo+ICsNCj4gKyAg
ICAgICAgICAgICAgIC8qIDIgYnl0ZXMgcGVyIGNsb2NrIGN5Y2xlIGluIERUUiBtb2RlLiAqLw0K
PiArICAgICAgICAgICAgICAgb3AtPmR1bW15Lm5ieXRlcyAqPSAyOw0KPiArDQo+ICsgICAgICAg
ICAgICAgICBleHQgPSBzcGlfbm9yX2dldF9jbWRfZXh0KG5vciwgb3ApOw0KPiArICAgICAgICAg
ICAgICAgb3AtPmNtZC5vcGNvZGUgPSAob3AtPmNtZC5vcGNvZGUgPDwgOCkgfCBleHQ7DQo+ICsg
ICAgICAgICAgICAgICBvcC0+Y21kLm5ieXRlcyA9IDI7DQo+ICsgICAgICAgfQ0KPiArfQ0KPiAr
DQo+ICAvKioNCj4gICAqIHNwaV9ub3Jfc3BpbWVtX2JvdW5jZSgpIC0gY2hlY2sgaWYgYSBib3Vu
Y2UgYnVmZmVyIGlzIG5lZWRlZCBmb3IgdGhlIGRhdGENCj4gICAqICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdHJhbnNmZXINCj4gQEAgLTg1LDE3ICsxNTcsMjYgQEAgc3RhdGljIGludCBzcGlf
bm9yX3NwaW1lbV9leGVjX29wKHN0cnVjdCBzcGlfbm9yICpub3IsIHN0cnVjdCBzcGlfbWVtX29w
ICpvcCkNCj4gIHN0YXRpYyBpbnQgc3BpX25vcl9jb250cm9sbGVyX29wc19yZWFkX3JlZyhzdHJ1
Y3Qgc3BpX25vciAqbm9yLCB1OCBvcGNvZGUsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1OCAqYnVmLCBzaXplX3QgbGVuKQ0KPiAgew0KPiArICAgICAgIGlm
IChzcGlfbm9yX3Byb3RvY29sX2lzX2R0cihub3ItPnJlZ19wcm90bykpDQo+ICsgICAgICAgICAg
ICAgICByZXR1cm4gLUVPUE5PVFNVUFA7DQo+ICsNCj4gICAgICAgICByZXR1cm4gbm9yLT5jb250
cm9sbGVyX29wcy0+cmVhZF9yZWcobm9yLCBvcGNvZGUsIGJ1ZiwgbGVuKTsNCj4gIH0NCj4gDQo+
ICBzdGF0aWMgaW50IHNwaV9ub3JfY29udHJvbGxlcl9vcHNfd3JpdGVfcmVnKHN0cnVjdCBzcGlf
bm9yICpub3IsIHU4IG9wY29kZSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCB1OCAqYnVmLCBzaXplX3QgbGVuKQ0KPiAgew0KPiArICAgICAgIGlm
IChzcGlfbm9yX3Byb3RvY29sX2lzX2R0cihub3ItPnJlZ19wcm90bykpDQo+ICsgICAgICAgICAg
ICAgICByZXR1cm4gLUVPUE5PVFNVUFA7DQo+ICsNCj4gICAgICAgICByZXR1cm4gbm9yLT5jb250
cm9sbGVyX29wcy0+d3JpdGVfcmVnKG5vciwgb3Bjb2RlLCBidWYsIGxlbik7DQo+ICB9DQo+IA0K
PiAgc3RhdGljIGludCBzcGlfbm9yX2NvbnRyb2xsZXJfb3BzX2VyYXNlKHN0cnVjdCBzcGlfbm9y
ICpub3IsIGxvZmZfdCBvZmZzKQ0KPiAgew0KPiArICAgICAgIGlmIChzcGlfbm9yX3Byb3RvY29s
X2lzX2R0cihub3ItPndyaXRlX3Byb3RvKSkNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU9Q
Tk9UU1VQUDsNCj4gKw0KPiAgICAgICAgIHJldHVybiBub3ItPmNvbnRyb2xsZXJfb3BzLT5lcmFz
ZShub3IsIG9mZnMpOw0KPiAgfQ0KPiANCj4gQEAgLTExMywyMiArMTk0LDIwIEBAIHN0YXRpYyBz
c2l6ZV90IHNwaV9ub3Jfc3BpbWVtX3JlYWRfZGF0YShzdHJ1Y3Qgc3BpX25vciAqbm9yLCBsb2Zm
X3QgZnJvbSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVf
dCBsZW4sIHU4ICpidWYpDQo+ICB7DQo+ICAgICAgICAgc3RydWN0IHNwaV9tZW1fb3Agb3AgPQ0K
PiAtICAgICAgICAgICAgICAgU1BJX01FTV9PUChTUElfTUVNX09QX0NNRChub3ItPnJlYWRfb3Bj
b2RlLCAxKSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9BRERSKG5v
ci0+YWRkcl93aWR0aCwgZnJvbSwgMSksDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgIFNQ
SV9NRU1fT1BfRFVNTVkobm9yLT5yZWFkX2R1bW15LCAxKSwNCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgU1BJX01FTV9PUF9EQVRBX0lOKGxlbiwgYnVmLCAxKSk7DQo+ICsgICAgICAgICAg
ICAgICBTUElfTUVNX09QKFNQSV9NRU1fT1BfQ01EKG5vci0+cmVhZF9vcGNvZGUsIDApLA0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0FERFIobm9yLT5hZGRyX3dpZHRo
LCBmcm9tLCAwKSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9EVU1N
WShub3ItPnJlYWRfZHVtbXksIDApLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICBTUElf
TUVNX09QX0RBVEFfSU4obGVuLCBidWYsIDApKTsNCj4gICAgICAgICBib29sIHVzZWJvdW5jZWJ1
ZjsNCj4gICAgICAgICBzc2l6ZV90IG5ieXRlczsNCj4gICAgICAgICBpbnQgZXJyb3I7DQo+IA0K
PiAtICAgICAgIC8qIGdldCB0cmFuc2ZlciBwcm90b2NvbHMuICovDQo+IC0gICAgICAgb3AuY21k
LmJ1c3dpZHRoID0gc3BpX25vcl9nZXRfcHJvdG9jb2xfaW5zdF9uYml0cyhub3ItPnJlYWRfcHJv
dG8pOw0KPiAtICAgICAgIG9wLmFkZHIuYnVzd2lkdGggPSBzcGlfbm9yX2dldF9wcm90b2NvbF9h
ZGRyX25iaXRzKG5vci0+cmVhZF9wcm90byk7DQo+IC0gICAgICAgb3AuZHVtbXkuYnVzd2lkdGgg
PSBvcC5hZGRyLmJ1c3dpZHRoOw0KPiAtICAgICAgIG9wLmRhdGEuYnVzd2lkdGggPSBzcGlfbm9y
X2dldF9wcm90b2NvbF9kYXRhX25iaXRzKG5vci0+cmVhZF9wcm90byk7DQo+ICsgICAgICAgc3Bp
X25vcl9zcGltZW1fc2V0dXBfb3Aobm9yLCAmb3AsIG5vci0+cmVhZF9wcm90byk7DQo+IA0KPiAg
ICAgICAgIC8qIGNvbnZlcnQgdGhlIGR1bW15IGN5Y2xlcyB0byB0aGUgbnVtYmVyIG9mIGJ5dGVz
ICovDQo+ICAgICAgICAgb3AuZHVtbXkubmJ5dGVzID0gKG5vci0+cmVhZF9kdW1teSAqIG9wLmR1
bW15LmJ1c3dpZHRoKSAvIDg7DQo+ICsgICAgICAgaWYgKHNwaV9ub3JfcHJvdG9jb2xfaXNfZHRy
KG5vci0+cmVhZF9wcm90bykpDQo+ICsgICAgICAgICAgICAgICBvcC5kdW1teS5uYnl0ZXMgKj0g
MjsNCj4gDQo+ICAgICAgICAgdXNlYm91bmNlYnVmID0gc3BpX25vcl9zcGltZW1fYm91bmNlKG5v
ciwgJm9wKTsNCj4gDQo+IEBAIC0xNzksMjAgKzI1OCwxOCBAQCBzdGF0aWMgc3NpemVfdCBzcGlf
bm9yX3NwaW1lbV93cml0ZV9kYXRhKHN0cnVjdCBzcGlfbm9yICpub3IsIGxvZmZfdCB0bywNCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplX3QgbGVuLCBjb25z
dCB1OCAqYnVmKQ0KPiAgew0KPiAgICAgICAgIHN0cnVjdCBzcGlfbWVtX29wIG9wID0NCj4gLSAg
ICAgICAgICAgICAgIFNQSV9NRU1fT1AoU1BJX01FTV9PUF9DTUQobm9yLT5wcm9ncmFtX29wY29k
ZSwgMSksDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfQUREUihub3It
PmFkZHJfd2lkdGgsIHRvLCAxKSwNCj4gKyAgICAgICAgICAgICAgIFNQSV9NRU1fT1AoU1BJX01F
TV9PUF9DTUQobm9yLT5wcm9ncmFtX29wY29kZSwgMCksDQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgIFNQSV9NRU1fT1BfQUREUihub3ItPmFkZHJfd2lkdGgsIHRvLCAwKSwNCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9OT19EVU1NWSwNCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgU1BJX01FTV9PUF9EQVRBX09VVChsZW4sIGJ1ZiwgMSkpOw0KPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0RBVEFfT1VUKGxlbiwgYnVmLCAwKSk7
DQo+ICAgICAgICAgc3NpemVfdCBuYnl0ZXM7DQo+ICAgICAgICAgaW50IGVycm9yOw0KPiANCj4g
LSAgICAgICBvcC5jbWQuYnVzd2lkdGggPSBzcGlfbm9yX2dldF9wcm90b2NvbF9pbnN0X25iaXRz
KG5vci0+d3JpdGVfcHJvdG8pOw0KPiAtICAgICAgIG9wLmFkZHIuYnVzd2lkdGggPSBzcGlfbm9y
X2dldF9wcm90b2NvbF9hZGRyX25iaXRzKG5vci0+d3JpdGVfcHJvdG8pOw0KPiAtICAgICAgIG9w
LmRhdGEuYnVzd2lkdGggPSBzcGlfbm9yX2dldF9wcm90b2NvbF9kYXRhX25iaXRzKG5vci0+d3Jp
dGVfcHJvdG8pOw0KPiAtDQo+ICAgICAgICAgaWYgKG5vci0+cHJvZ3JhbV9vcGNvZGUgPT0gU1BJ
Tk9SX09QX0FBSV9XUCAmJiBub3ItPnNzdF93cml0ZV9zZWNvbmQpDQo+ICAgICAgICAgICAgICAg
ICBvcC5hZGRyLm5ieXRlcyA9IDA7DQo+IA0KPiArICAgICAgIHNwaV9ub3Jfc3BpbWVtX3NldHVw
X29wKG5vciwgJm9wLCBub3ItPndyaXRlX3Byb3RvKTsNCj4gKw0KPiAgICAgICAgIGlmIChzcGlf
bm9yX3NwaW1lbV9ib3VuY2Uobm9yLCAmb3ApKQ0KPiAgICAgICAgICAgICAgICAgbWVtY3B5KG5v
ci0+Ym91bmNlYnVmLCBidWYsIG9wLmRhdGEubmJ5dGVzKTsNCj4gDQo+IEBAIC0yMzksMTEgKzMx
NiwxMyBAQCBpbnQgc3BpX25vcl93cml0ZV9lbmFibGUoc3RydWN0IHNwaV9ub3IgKm5vcikNCj4g
DQo+ICAgICAgICAgaWYgKG5vci0+c3BpbWVtKSB7DQo+ICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
c3BpX21lbV9vcCBvcCA9DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1AoU1BJ
X01FTV9PUF9DTUQoU1BJTk9SX09QX1dSRU4sIDEpLA0KPiArICAgICAgICAgICAgICAgICAgICAg
ICBTUElfTUVNX09QKFNQSV9NRU1fT1BfQ01EKFNQSU5PUl9PUF9XUkVOLCAwKSwNCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX05PX0FERFIsDQo+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9OT19EVU1NWSwNCj4gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX05PX0RBVEEpOw0KPiAN
Cj4gKyAgICAgICAgICAgICAgIHNwaV9ub3Jfc3BpbWVtX3NldHVwX29wKG5vciwgJm9wLCBub3It
PnJlZ19wcm90byk7DQo+ICsNCj4gICAgICAgICAgICAgICAgIHJldCA9IHNwaV9tZW1fZXhlY19v
cChub3ItPnNwaW1lbSwgJm9wKTsNCj4gICAgICAgICB9IGVsc2Ugew0KPiAgICAgICAgICAgICAg
ICAgcmV0ID0gc3BpX25vcl9jb250cm9sbGVyX29wc193cml0ZV9yZWcobm9yLCBTUElOT1JfT1Bf
V1JFTiwNCj4gQEAgLTI2OCwxMSArMzQ3LDEzIEBAIGludCBzcGlfbm9yX3dyaXRlX2Rpc2FibGUo
c3RydWN0IHNwaV9ub3IgKm5vcikNCj4gDQo+ICAgICAgICAgaWYgKG5vci0+c3BpbWVtKSB7DQo+
ICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc3BpX21lbV9vcCBvcCA9DQo+IC0gICAgICAgICAgICAg
ICAgICAgICAgIFNQSV9NRU1fT1AoU1BJX01FTV9PUF9DTUQoU1BJTk9SX09QX1dSREksIDEpLA0K
PiArICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QKFNQSV9NRU1fT1BfQ01EKFNQSU5P
Ul9PUF9XUkRJLCAwKSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElf
TUVNX09QX05PX0FERFIsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJ
X01FTV9PUF9OT19EVU1NWSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBT
UElfTUVNX09QX05PX0RBVEEpOw0KPiANCj4gKyAgICAgICAgICAgICAgIHNwaV9ub3Jfc3BpbWVt
X3NldHVwX29wKG5vciwgJm9wLCBub3ItPnJlZ19wcm90byk7DQo+ICsNCj4gICAgICAgICAgICAg
ICAgIHJldCA9IHNwaV9tZW1fZXhlY19vcChub3ItPnNwaW1lbSwgJm9wKTsNCj4gICAgICAgICB9
IGVsc2Ugew0KPiAgICAgICAgICAgICAgICAgcmV0ID0gc3BpX25vcl9jb250cm9sbGVyX29wc193
cml0ZV9yZWcobm9yLCBTUElOT1JfT1BfV1JESSwNCj4gQEAgLTI5OSwxMCArMzgwLDEyIEBAIHN0
YXRpYyBpbnQgc3BpX25vcl9yZWFkX3NyKHN0cnVjdCBzcGlfbm9yICpub3IsIHU4ICpzcikNCj4g
DQo+ICAgICAgICAgaWYgKG5vci0+c3BpbWVtKSB7DQo+ICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
c3BpX21lbV9vcCBvcCA9DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1AoU1BJ
X01FTV9PUF9DTUQoU1BJTk9SX09QX1JEU1IsIDEpLA0KPiArICAgICAgICAgICAgICAgICAgICAg
ICBTUElfTUVNX09QKFNQSV9NRU1fT1BfQ01EKFNQSU5PUl9PUF9SRFNSLCAwKSwNCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX05PX0FERFIsDQo+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9OT19EVU1NWSwNCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0RBVEFfSU4oMSwgc3Is
IDEpKTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0RB
VEFfSU4oMSwgc3IsIDApKTsNCj4gKw0KPiArICAgICAgICAgICAgICAgc3BpX25vcl9zcGltZW1f
c2V0dXBfb3Aobm9yLCAmb3AsIG5vci0+cmVnX3Byb3RvKTsNCj4gDQo+ICAgICAgICAgICAgICAg
ICByZXQgPSBzcGlfbWVtX2V4ZWNfb3Aobm9yLT5zcGltZW0sICZvcCk7DQo+ICAgICAgICAgfSBl
bHNlIHsNCj4gQEAgLTMzMCwxMCArNDEzLDEyIEBAIHN0YXRpYyBpbnQgc3BpX25vcl9yZWFkX2Zz
cihzdHJ1Y3Qgc3BpX25vciAqbm9yLCB1OCAqZnNyKQ0KPiANCj4gICAgICAgICBpZiAobm9yLT5z
cGltZW0pIHsNCj4gICAgICAgICAgICAgICAgIHN0cnVjdCBzcGlfbWVtX29wIG9wID0NCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUChTUElfTUVNX09QX0NNRChTUElOT1JfT1Bf
UkRGU1IsIDEpLA0KPiArICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QKFNQSV9NRU1f
T1BfQ01EKFNQSU5PUl9PUF9SREZTUiwgMCksDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgU1BJX01FTV9PUF9OT19BRERSLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFNQSV9NRU1fT1BfTk9fRFVNTVksDQo+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgU1BJX01FTV9PUF9EQVRBX0lOKDEsIGZzciwgMSkpOw0KPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfREFUQV9JTigxLCBmc3IsIDApKTsN
Cj4gKw0KPiArICAgICAgICAgICAgICAgc3BpX25vcl9zcGltZW1fc2V0dXBfb3Aobm9yLCAmb3As
IG5vci0+cmVnX3Byb3RvKTsNCj4gDQo+ICAgICAgICAgICAgICAgICByZXQgPSBzcGlfbWVtX2V4
ZWNfb3Aobm9yLT5zcGltZW0sICZvcCk7DQo+ICAgICAgICAgfSBlbHNlIHsNCj4gQEAgLTM2Miwx
MCArNDQ3LDEyIEBAIHN0YXRpYyBpbnQgc3BpX25vcl9yZWFkX2NyKHN0cnVjdCBzcGlfbm9yICpu
b3IsIHU4ICpjcikNCj4gDQo+ICAgICAgICAgaWYgKG5vci0+c3BpbWVtKSB7DQo+ICAgICAgICAg
ICAgICAgICBzdHJ1Y3Qgc3BpX21lbV9vcCBvcCA9DQo+IC0gICAgICAgICAgICAgICAgICAgICAg
IFNQSV9NRU1fT1AoU1BJX01FTV9PUF9DTUQoU1BJTk9SX09QX1JEQ1IsIDEpLA0KPiArICAgICAg
ICAgICAgICAgICAgICAgICBTUElfTUVNX09QKFNQSV9NRU1fT1BfQ01EKFNQSU5PUl9PUF9SRENS
LCAwKSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX05P
X0FERFIsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9O
T19EVU1NWSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09Q
X0RBVEFfSU4oMSwgY3IsIDEpKTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBTUElfTUVNX09QX0RBVEFfSU4oMSwgY3IsIDApKTsNCj4gKw0KPiArICAgICAgICAgICAgICAg
c3BpX25vcl9zcGltZW1fc2V0dXBfb3Aobm9yLCAmb3AsIG5vci0+cmVnX3Byb3RvKTsNCj4gDQo+
ICAgICAgICAgICAgICAgICByZXQgPSBzcGlfbWVtX2V4ZWNfb3Aobm9yLT5zcGltZW0sICZvcCk7
DQo+ICAgICAgICAgfSBlbHNlIHsNCj4gQEAgLTM5NiwxMSArNDgzLDEzIEBAIGludCBzcGlfbm9y
X3NldF80Ynl0ZV9hZGRyX21vZGUoc3RydWN0IHNwaV9ub3IgKm5vciwgYm9vbCBlbmFibGUpDQo+
ICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1AoU1BJX01FTV9PUF9DTUQoZW5hYmxl
ID8NCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBT
UElOT1JfT1BfRU40QiA6DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgU1BJTk9SX09QX0VYNEIsDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgMSksDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgMCksDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBTUElfTUVNX09QX05PX0FERFIsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBTUElfTUVNX09QX05PX0RVTU1ZLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgU1BJX01FTV9PUF9OT19EQVRBKTsNCj4gDQo+ICsgICAgICAgICAgICAgICBzcGlf
bm9yX3NwaW1lbV9zZXR1cF9vcChub3IsICZvcCwgbm9yLT5yZWdfcHJvdG8pOw0KPiArDQo+ICAg
ICAgICAgICAgICAgICByZXQgPSBzcGlfbWVtX2V4ZWNfb3Aobm9yLT5zcGltZW0sICZvcCk7DQo+
ICAgICAgICAgfSBlbHNlIHsNCj4gICAgICAgICAgICAgICAgIHJldCA9IHNwaV9ub3JfY29udHJv
bGxlcl9vcHNfd3JpdGVfcmVnKG5vciwNCj4gQEAgLTQzMiwxMCArNTIxLDEyIEBAIHN0YXRpYyBp
bnQgc3BhbnNpb25fc2V0XzRieXRlX2FkZHJfbW9kZShzdHJ1Y3Qgc3BpX25vciAqbm9yLCBib29s
IGVuYWJsZSkNCj4gDQo+ICAgICAgICAgaWYgKG5vci0+c3BpbWVtKSB7DQo+ICAgICAgICAgICAg
ICAgICBzdHJ1Y3Qgc3BpX21lbV9vcCBvcCA9DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIFNQ
SV9NRU1fT1AoU1BJX01FTV9PUF9DTUQoU1BJTk9SX09QX0JSV1IsIDEpLA0KPiArICAgICAgICAg
ICAgICAgICAgICAgICBTUElfTUVNX09QKFNQSV9NRU1fT1BfQ01EKFNQSU5PUl9PUF9CUldSLCAw
KSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX05PX0FE
RFIsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9OT19E
VU1NWSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0RB
VEFfT1VUKDEsIG5vci0+Ym91bmNlYnVmLCAxKSk7DQo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgU1BJX01FTV9PUF9EQVRBX09VVCgxLCBub3ItPmJvdW5jZWJ1ZiwgMCkpOw0K
PiArDQo+ICsgICAgICAgICAgICAgICBzcGlfbm9yX3NwaW1lbV9zZXR1cF9vcChub3IsICZvcCwg
bm9yLT5yZWdfcHJvdG8pOw0KPiANCj4gICAgICAgICAgICAgICAgIHJldCA9IHNwaV9tZW1fZXhl
Y19vcChub3ItPnNwaW1lbSwgJm9wKTsNCj4gICAgICAgICB9IGVsc2Ugew0KPiBAQCAtNDY0LDEw
ICs1NTUsMTIgQEAgaW50IHNwaV9ub3Jfd3JpdGVfZWFyKHN0cnVjdCBzcGlfbm9yICpub3IsIHU4
IGVhcikNCj4gDQo+ICAgICAgICAgaWYgKG5vci0+c3BpbWVtKSB7DQo+ICAgICAgICAgICAgICAg
ICBzdHJ1Y3Qgc3BpX21lbV9vcCBvcCA9DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIFNQSV9N
RU1fT1AoU1BJX01FTV9PUF9DTUQoU1BJTk9SX09QX1dSRUFSLCAxKSwNCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgU1BJX01FTV9PUChTUElfTUVNX09QX0NNRChTUElOT1JfT1BfV1JFQVIsIDAp
LA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfTk9fQURE
UiwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX05PX0RV
TU1ZLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfREFU
QV9PVVQoMSwgbm9yLT5ib3VuY2VidWYsIDEpKTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBTUElfTUVNX09QX0RBVEFfT1VUKDEsIG5vci0+Ym91bmNlYnVmLCAwKSk7DQo+
ICsNCj4gKyAgICAgICAgICAgICAgIHNwaV9ub3Jfc3BpbWVtX3NldHVwX29wKG5vciwgJm9wLCBu
b3ItPnJlZ19wcm90byk7DQo+IA0KPiAgICAgICAgICAgICAgICAgcmV0ID0gc3BpX21lbV9leGVj
X29wKG5vci0+c3BpbWVtLCAmb3ApOw0KPiAgICAgICAgIH0gZWxzZSB7DQo+IEBAIC00OTUsMTAg
KzU4OCwxMiBAQCBpbnQgc3BpX25vcl94cmVhZF9zcihzdHJ1Y3Qgc3BpX25vciAqbm9yLCB1OCAq
c3IpDQo+IA0KPiAgICAgICAgIGlmIChub3ItPnNwaW1lbSkgew0KPiAgICAgICAgICAgICAgICAg
c3RydWN0IHNwaV9tZW1fb3Agb3AgPQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVN
X09QKFNQSV9NRU1fT1BfQ01EKFNQSU5PUl9PUF9YUkRTUiwgMSksDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIFNQSV9NRU1fT1AoU1BJX01FTV9PUF9DTUQoU1BJTk9SX09QX1hSRFNSLCAwKSwN
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX05PX0FERFIs
DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9OT19EVU1N
WSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0RBVEFf
SU4oMSwgc3IsIDEpKTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElf
TUVNX09QX0RBVEFfSU4oMSwgc3IsIDApKTsNCj4gKw0KPiArICAgICAgICAgICAgICAgc3BpX25v
cl9zcGltZW1fc2V0dXBfb3Aobm9yLCAmb3AsIG5vci0+cmVnX3Byb3RvKTsNCj4gDQo+ICAgICAg
ICAgICAgICAgICByZXQgPSBzcGlfbWVtX2V4ZWNfb3Aobm9yLT5zcGltZW0sICZvcCk7DQo+ICAg
ICAgICAgfSBlbHNlIHsNCj4gQEAgLTU0MCwxMSArNjM1LDEzIEBAIHN0YXRpYyB2b2lkIHNwaV9u
b3JfY2xlYXJfc3Ioc3RydWN0IHNwaV9ub3IgKm5vcikNCj4gDQo+ICAgICAgICAgaWYgKG5vci0+
c3BpbWVtKSB7DQo+ICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc3BpX21lbV9vcCBvcCA9DQo+IC0g
ICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1AoU1BJX01FTV9PUF9DTUQoU1BJTk9SX09Q
X0NMU1IsIDEpLA0KPiArICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QKFNQSV9NRU1f
T1BfQ01EKFNQSU5PUl9PUF9DTFNSLCAwKSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBTUElfTUVNX09QX05PX0FERFIsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgU1BJX01FTV9PUF9OT19EVU1NWSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBTUElfTUVNX09QX05PX0RBVEEpOw0KPiANCj4gKyAgICAgICAgICAgICAgIHNw
aV9ub3Jfc3BpbWVtX3NldHVwX29wKG5vciwgJm9wLCBub3ItPnJlZ19wcm90byk7DQo+ICsNCj4g
ICAgICAgICAgICAgICAgIHJldCA9IHNwaV9tZW1fZXhlY19vcChub3ItPnNwaW1lbSwgJm9wKTsN
Cj4gICAgICAgICB9IGVsc2Ugew0KPiAgICAgICAgICAgICAgICAgcmV0ID0gc3BpX25vcl9jb250
cm9sbGVyX29wc193cml0ZV9yZWcobm9yLCBTUElOT1JfT1BfQ0xTUiwNCj4gQEAgLTYwNCwxMSAr
NzAxLDEzIEBAIHN0YXRpYyB2b2lkIHNwaV9ub3JfY2xlYXJfZnNyKHN0cnVjdCBzcGlfbm9yICpu
b3IpDQo+IA0KPiAgICAgICAgIGlmIChub3ItPnNwaW1lbSkgew0KPiAgICAgICAgICAgICAgICAg
c3RydWN0IHNwaV9tZW1fb3Agb3AgPQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVN
X09QKFNQSV9NRU1fT1BfQ01EKFNQSU5PUl9PUF9DTEZTUiwgMSksDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIFNQSV9NRU1fT1AoU1BJX01FTV9PUF9DTUQoU1BJTk9SX09QX0NMRlNSLCAwKSwN
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX05PX0FERFIs
DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9OT19EVU1N
WSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX05PX0RB
VEEpOw0KPiANCj4gKyAgICAgICAgICAgICAgIHNwaV9ub3Jfc3BpbWVtX3NldHVwX29wKG5vciwg
Jm9wLCBub3ItPnJlZ19wcm90byk7DQo+ICsNCj4gICAgICAgICAgICAgICAgIHJldCA9IHNwaV9t
ZW1fZXhlY19vcChub3ItPnNwaW1lbSwgJm9wKTsNCj4gICAgICAgICB9IGVsc2Ugew0KPiAgICAg
ICAgICAgICAgICAgcmV0ID0gc3BpX25vcl9jb250cm9sbGVyX29wc193cml0ZV9yZWcobm9yLCBT
UElOT1JfT1BfQ0xGU1IsDQo+IEBAIC03NDgsMTAgKzg0NywxMiBAQCBzdGF0aWMgaW50IHNwaV9u
b3Jfd3JpdGVfc3Ioc3RydWN0IHNwaV9ub3IgKm5vciwgY29uc3QgdTggKnNyLCBzaXplX3QgbGVu
KQ0KPiANCj4gICAgICAgICBpZiAobm9yLT5zcGltZW0pIHsNCj4gICAgICAgICAgICAgICAgIHN0
cnVjdCBzcGlfbWVtX29wIG9wID0NCj4gLSAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9P
UChTUElfTUVNX09QX0NNRChTUElOT1JfT1BfV1JTUiwgMSksDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIFNQSV9NRU1fT1AoU1BJX01FTV9PUF9DTUQoU1BJTk9SX09QX1dSU1IsIDApLA0KPiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfTk9fQUREUiwNCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX05PX0RVTU1ZLA0K
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfREFUQV9PVVQo
bGVuLCBzciwgMSkpOw0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9N
RU1fT1BfREFUQV9PVVQobGVuLCBzciwgMCkpOw0KPiArDQo+ICsgICAgICAgICAgICAgICBzcGlf
bm9yX3NwaW1lbV9zZXR1cF9vcChub3IsICZvcCwgbm9yLT5yZWdfcHJvdG8pOw0KPiANCj4gICAg
ICAgICAgICAgICAgIHJldCA9IHNwaV9tZW1fZXhlY19vcChub3ItPnNwaW1lbSwgJm9wKTsNCj4g
ICAgICAgICB9IGVsc2Ugew0KPiBAQCAtOTUwLDEwICsxMDUxLDEyIEBAIHN0YXRpYyBpbnQgc3Bp
X25vcl93cml0ZV9zcjIoc3RydWN0IHNwaV9ub3IgKm5vciwgY29uc3QgdTggKnNyMikNCj4gDQo+
ICAgICAgICAgaWYgKG5vci0+c3BpbWVtKSB7DQo+ICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc3Bp
X21lbV9vcCBvcCA9DQo+IC0gICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1AoU1BJX01F
TV9PUF9DTUQoU1BJTk9SX09QX1dSU1IyLCAxKSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
U1BJX01FTV9PUChTUElfTUVNX09QX0NNRChTUElOT1JfT1BfV1JTUjIsIDApLA0KPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfTk9fQUREUiwNCj4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX05PX0RVTU1ZLA0KPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfREFUQV9PVVQoMSwgc3Iy
LCAxKSk7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9E
QVRBX09VVCgxLCBzcjIsIDApKTsNCj4gKw0KPiArICAgICAgICAgICAgICAgc3BpX25vcl9zcGlt
ZW1fc2V0dXBfb3Aobm9yLCAmb3AsIG5vci0+cmVnX3Byb3RvKTsNCj4gDQo+ICAgICAgICAgICAg
ICAgICByZXQgPSBzcGlfbWVtX2V4ZWNfb3Aobm9yLT5zcGltZW0sICZvcCk7DQo+ICAgICAgICAg
fSBlbHNlIHsNCj4gQEAgLTk4NCwxMCArMTA4NywxMiBAQCBzdGF0aWMgaW50IHNwaV9ub3JfcmVh
ZF9zcjIoc3RydWN0IHNwaV9ub3IgKm5vciwgdTggKnNyMikNCj4gDQo+ICAgICAgICAgaWYgKG5v
ci0+c3BpbWVtKSB7DQo+ICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc3BpX21lbV9vcCBvcCA9DQo+
IC0gICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1AoU1BJX01FTV9PUF9DTUQoU1BJTk9S
X09QX1JEU1IyLCAxKSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUChTUElf
TUVNX09QX0NNRChTUElOT1JfT1BfUkRTUjIsIDApLA0KPiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFNQSV9NRU1fT1BfTk9fQUREUiwNCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBTUElfTUVNX09QX05PX0RVTU1ZLA0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfREFUQV9JTigxLCBzcjIsIDEpKTsNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0RBVEFfSU4oMSwgc3IyLCAw
KSk7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIHNwaV9ub3Jfc3BpbWVtX3NldHVwX29wKG5vciwg
Jm9wLCBub3ItPnJlZ19wcm90byk7DQo+IA0KPiAgICAgICAgICAgICAgICAgcmV0ID0gc3BpX21l
bV9leGVjX29wKG5vci0+c3BpbWVtLCAmb3ApOw0KPiAgICAgICAgIH0gZWxzZSB7DQo+IEBAIC0x
MDE1LDExICsxMTIwLDEzIEBAIHN0YXRpYyBpbnQgc3BpX25vcl9lcmFzZV9jaGlwKHN0cnVjdCBz
cGlfbm9yICpub3IpDQo+IA0KPiAgICAgICAgIGlmIChub3ItPnNwaW1lbSkgew0KPiAgICAgICAg
ICAgICAgICAgc3RydWN0IHNwaV9tZW1fb3Agb3AgPQ0KPiAtICAgICAgICAgICAgICAgICAgICAg
ICBTUElfTUVNX09QKFNQSV9NRU1fT1BfQ01EKFNQSU5PUl9PUF9DSElQX0VSQVNFLCAxKSwNCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUChTUElfTUVNX09QX0NNRChTUElOT1Jf
T1BfQ0hJUF9FUkFTRSwgMCksDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
U1BJX01FTV9PUF9OT19BRERSLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFNQSV9NRU1fT1BfTk9fRFVNTVksDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgU1BJX01FTV9PUF9OT19EQVRBKTsNCj4gDQo+ICsgICAgICAgICAgICAgICBzcGlfbm9yX3Nw
aW1lbV9zZXR1cF9vcChub3IsICZvcCwgbm9yLT53cml0ZV9wcm90byk7DQo+ICsNCj4gICAgICAg
ICAgICAgICAgIHJldCA9IHNwaV9tZW1fZXhlY19vcChub3ItPnNwaW1lbSwgJm9wKTsNCj4gICAg
ICAgICB9IGVsc2Ugew0KPiAgICAgICAgICAgICAgICAgcmV0ID0gc3BpX25vcl9jb250cm9sbGVy
X29wc193cml0ZV9yZWcobm9yLA0KPiBAQCAtMTE1OCwxMSArMTI2NSwxMyBAQCBzdGF0aWMgaW50
IHNwaV9ub3JfZXJhc2Vfc2VjdG9yKHN0cnVjdCBzcGlfbm9yICpub3IsIHUzMiBhZGRyKQ0KPiAN
Cj4gICAgICAgICBpZiAobm9yLT5zcGltZW0pIHsNCj4gICAgICAgICAgICAgICAgIHN0cnVjdCBz
cGlfbWVtX29wIG9wID0NCj4gLSAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUChTUElf
TUVNX09QX0NNRChub3ItPmVyYXNlX29wY29kZSwgMSksDQo+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgU1BJX01FTV9PUF9BRERSKG5vci0+YWRkcl93aWR0aCwgYWRkciwgMSks
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1AoU1BJX01FTV9PUF9DTUQobm9y
LT5lcmFzZV9vcGNvZGUsIDApLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFNQSV9NRU1fT1BfQUREUihub3ItPmFkZHJfd2lkdGgsIGFkZHIsIDApLA0KPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfTk9fRFVNTVksDQo+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9OT19EQVRBKTsNCj4gDQo+ICsg
ICAgICAgICAgICAgICBzcGlfbm9yX3NwaW1lbV9zZXR1cF9vcChub3IsICZvcCwgbm9yLT53cml0
ZV9wcm90byk7DQo+ICsNCj4gICAgICAgICAgICAgICAgIHJldHVybiBzcGlfbWVtX2V4ZWNfb3Ao
bm9yLT5zcGltZW0sICZvcCk7DQo+ICAgICAgICAgfSBlbHNlIGlmIChub3ItPmNvbnRyb2xsZXJf
b3BzLT5lcmFzZSkgew0KPiAgICAgICAgICAgICAgICAgcmV0dXJuIHNwaV9ub3JfY29udHJvbGxl
cl9vcHNfZXJhc2Uobm9yLCBhZGRyKTsNCj4gQEAgLTIyNzIsNiArMjM4MSw3IEBAIGludCBzcGlf
bm9yX2h3Y2Fwc19yZWFkMmNtZCh1MzIgaHdjYXBzKQ0KPiAgICAgICAgICAgICAgICAgeyBTTk9S
X0hXQ0FQU19SRUFEXzFfOF84LCAgICAgICBTTk9SX0NNRF9SRUFEXzFfOF84IH0sDQo+ICAgICAg
ICAgICAgICAgICB7IFNOT1JfSFdDQVBTX1JFQURfOF84XzgsICAgICAgIFNOT1JfQ01EX1JFQURf
OF84XzggfSwNCj4gICAgICAgICAgICAgICAgIHsgU05PUl9IV0NBUFNfUkVBRF8xXzhfOF9EVFIs
ICAgU05PUl9DTURfUkVBRF8xXzhfOF9EVFIgfSwNCj4gKyAgICAgICAgICAgICAgIHsgU05PUl9I
V0NBUFNfUkVBRF84XzhfOF9EVFIsICAgU05PUl9DTURfUkVBRF84XzhfOF9EVFIgfSwNCj4gICAg
ICAgICB9Ow0KPiANCj4gICAgICAgICByZXR1cm4gc3BpX25vcl9od2NhcHMyY21kKGh3Y2Fwcywg
aHdjYXBzX3JlYWQyY21kLA0KPiBAQCAtMjI4OCw2ICsyMzk4LDcgQEAgc3RhdGljIGludCBzcGlf
bm9yX2h3Y2Fwc19wcDJjbWQodTMyIGh3Y2FwcykNCj4gICAgICAgICAgICAgICAgIHsgU05PUl9I
V0NBUFNfUFBfMV8xXzgsICAgICAgICAgU05PUl9DTURfUFBfMV8xXzggfSwNCj4gICAgICAgICAg
ICAgICAgIHsgU05PUl9IV0NBUFNfUFBfMV84XzgsICAgICAgICAgU05PUl9DTURfUFBfMV84Xzgg
fSwNCj4gICAgICAgICAgICAgICAgIHsgU05PUl9IV0NBUFNfUFBfOF84XzgsICAgICAgICAgU05P
Ul9DTURfUFBfOF84XzggfSwNCj4gKyAgICAgICAgICAgICAgIHsgU05PUl9IV0NBUFNfUFBfOF84
XzhfRFRSLCAgICAgU05PUl9DTURfUFBfOF84XzhfRFRSIH0sDQo+ICAgICAgICAgfTsNCj4gDQo+
ICAgICAgICAgcmV0dXJuIHNwaV9ub3JfaHdjYXBzMmNtZChod2NhcHMsIGh3Y2Fwc19wcDJjbWQs
DQo+IEBAIC0yMzM2LDE3ICsyNDQ3LDE3IEBAIHN0YXRpYyBpbnQgc3BpX25vcl9zcGltZW1fY2hl
Y2tfb3Aoc3RydWN0IHNwaV9ub3IgKm5vciwNCj4gIHN0YXRpYyBpbnQgc3BpX25vcl9zcGltZW1f
Y2hlY2tfcmVhZG9wKHN0cnVjdCBzcGlfbm9yICpub3IsDQo+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBzcGlfbm9yX3JlYWRfY29tbWFuZCAqcmVh
ZCkNCj4gIHsNCj4gLSAgICAgICBzdHJ1Y3Qgc3BpX21lbV9vcCBvcCA9IFNQSV9NRU1fT1AoU1BJ
X01FTV9PUF9DTUQocmVhZC0+b3Bjb2RlLCAxKSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9BRERSKDMsIDAsIDEpLA0KPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0RVTU1ZKDAsIDEpLA0K
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0RB
VEFfSU4oMCwgTlVMTCwgMSkpOw0KPiArICAgICAgIHN0cnVjdCBzcGlfbWVtX29wIG9wID0gU1BJ
X01FTV9PUChTUElfTUVNX09QX0NNRChyZWFkLT5vcGNvZGUsIDApLA0KPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0FERFIoMywgMCwgMCksDQo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfRFVN
TVkoMSwgMCksDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQ
SV9NRU1fT1BfREFUQV9JTigxLCBOVUxMLCAwKSk7DQo+IA0KPiAtICAgICAgIG9wLmNtZC5idXN3
aWR0aCA9IHNwaV9ub3JfZ2V0X3Byb3RvY29sX2luc3RfbmJpdHMocmVhZC0+cHJvdG8pOw0KPiAt
ICAgICAgIG9wLmFkZHIuYnVzd2lkdGggPSBzcGlfbm9yX2dldF9wcm90b2NvbF9hZGRyX25iaXRz
KHJlYWQtPnByb3RvKTsNCj4gLSAgICAgICBvcC5kYXRhLmJ1c3dpZHRoID0gc3BpX25vcl9nZXRf
cHJvdG9jb2xfZGF0YV9uYml0cyhyZWFkLT5wcm90byk7DQo+IC0gICAgICAgb3AuZHVtbXkuYnVz
d2lkdGggPSBvcC5hZGRyLmJ1c3dpZHRoOw0KPiAtICAgICAgIG9wLmR1bW15Lm5ieXRlcyA9IChy
ZWFkLT5udW1fbW9kZV9jbG9ja3MgKyByZWFkLT5udW1fd2FpdF9zdGF0ZXMpICoNCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICBvcC5kdW1teS5idXN3aWR0aCAvIDg7DQo+ICsgICAgICAgc3Bp
X25vcl9zcGltZW1fc2V0dXBfb3Aobm9yLCAmb3AsIHJlYWQtPnByb3RvKTsNCj4gKw0KPiArICAg
ICAgIC8qIGNvbnZlcnQgdGhlIGR1bW15IGN5Y2xlcyB0byB0aGUgbnVtYmVyIG9mIGJ5dGVzICov
DQo+ICsgICAgICAgb3AuZHVtbXkubmJ5dGVzID0gKG5vci0+cmVhZF9kdW1teSAqIG9wLmR1bW15
LmJ1c3dpZHRoKSAvIDg7DQo+ICsgICAgICAgaWYgKHNwaV9ub3JfcHJvdG9jb2xfaXNfZHRyKG5v
ci0+cmVhZF9wcm90bykpDQo+ICsgICAgICAgICAgICAgICBvcC5kdW1teS5uYnl0ZXMgKj0gMjsN
Cj4gDQo+ICAgICAgICAgcmV0dXJuIHNwaV9ub3Jfc3BpbWVtX2NoZWNrX29wKG5vciwgJm9wKTsN
Cj4gIH0NCj4gQEAgLTIzNjIsMTQgKzI0NzMsMTIgQEAgc3RhdGljIGludCBzcGlfbm9yX3NwaW1l
bV9jaGVja19yZWFkb3Aoc3RydWN0IHNwaV9ub3IgKm5vciwNCj4gIHN0YXRpYyBpbnQgc3BpX25v
cl9zcGltZW1fY2hlY2tfcHAoc3RydWN0IHNwaV9ub3IgKm5vciwNCj4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qgc3BpX25vcl9wcF9jb21tYW5kICpwcCkN
Cj4gIHsNCj4gLSAgICAgICBzdHJ1Y3Qgc3BpX21lbV9vcCBvcCA9IFNQSV9NRU1fT1AoU1BJX01F
TV9PUF9DTUQocHAtPm9wY29kZSwgMSksDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFNQSV9NRU1fT1BfQUREUigzLCAwLCAxKSwNCj4gKyAgICAgICBzdHJ1Y3Qg
c3BpX21lbV9vcCBvcCA9IFNQSV9NRU1fT1AoU1BJX01FTV9PUF9DTUQocHAtPm9wY29kZSwgMCks
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1Bf
QUREUigzLCAwLCAwKSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgU1BJX01FTV9PUF9OT19EVU1NWSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgU1BJX01FTV9PUF9EQVRBX09VVCgwLCBOVUxMLCAxKSk7DQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfREFUQV9PVVQoMSwg
TlVMTCwgMCkpOw0KPiANCj4gLSAgICAgICBvcC5jbWQuYnVzd2lkdGggPSBzcGlfbm9yX2dldF9w
cm90b2NvbF9pbnN0X25iaXRzKHBwLT5wcm90byk7DQo+IC0gICAgICAgb3AuYWRkci5idXN3aWR0
aCA9IHNwaV9ub3JfZ2V0X3Byb3RvY29sX2FkZHJfbmJpdHMocHAtPnByb3RvKTsNCj4gLSAgICAg
ICBvcC5kYXRhLmJ1c3dpZHRoID0gc3BpX25vcl9nZXRfcHJvdG9jb2xfZGF0YV9uYml0cyhwcC0+
cHJvdG8pOw0KPiArICAgICAgIHNwaV9ub3Jfc3BpbWVtX3NldHVwX29wKG5vciwgJm9wLCBwcC0+
cHJvdG8pOw0KPiANCj4gICAgICAgICByZXR1cm4gc3BpX25vcl9zcGltZW1fY2hlY2tfb3Aobm9y
LCAmb3ApOw0KPiAgfQ0KPiBAQCAtMjM4NywxMiArMjQ5NiwxNiBAQCBzcGlfbm9yX3NwaW1lbV9h
ZGp1c3RfaHdjYXBzKHN0cnVjdCBzcGlfbm9yICpub3IsIHUzMiAqaHdjYXBzKQ0KPiAgICAgICAg
IHN0cnVjdCBzcGlfbm9yX2ZsYXNoX3BhcmFtZXRlciAqcGFyYW1zID0gbm9yLT5wYXJhbXM7DQo+
ICAgICAgICAgdW5zaWduZWQgaW50IGNhcDsNCj4gDQo+IC0gICAgICAgLyogRFRSIG1vZGVzIGFy
ZSBub3Qgc3VwcG9ydGVkIHlldCwgbWFzayB0aGVtIGFsbC4gKi8NCj4gLSAgICAgICAqaHdjYXBz
ICY9IH5TTk9SX0hXQ0FQU19EVFI7DQo+IC0NCj4gICAgICAgICAvKiBYLVgtWCBtb2RlcyBhcmUg
bm90IHN1cHBvcnRlZCB5ZXQsIG1hc2sgdGhlbSBhbGwuICovDQo+ICAgICAgICAgKmh3Y2FwcyAm
PSB+U05PUl9IV0NBUFNfWF9YX1g7DQo+IA0KPiArICAgICAgIC8qDQo+ICsgICAgICAgICogSWYg
dGhlIHJlc2V0IGxpbmUgaXMgYnJva2VuLCB3ZSBkbyBub3Qgd2FudCB0byBlbnRlciBhIHN0YXRl
ZnVsDQo+ICsgICAgICAgICogbW9kZS4NCj4gKyAgICAgICAgKi8NCj4gKyAgICAgICBpZiAobm9y
LT5mbGFncyAmIFNOT1JfRl9CUk9LRU5fUkVTRVQpDQo+ICsgICAgICAgICAgICAgICAqaHdjYXBz
ICY9IH4oU05PUl9IV0NBUFNfWF9YX1ggfCBTTk9SX0hXQ0FQU19YX1hfWF9EVFIpOw0KDQpTTk9S
X0hXQ0FQU19YX1hfWCBpcyBhbHJlYWR5IG1hc2tlZCBvdXQgYWJvdmUuIERvIHdlIG5lZWQgdG8g
ZG8gaXQgYWdhaW4/DQoNCj4gKw0KPiAgICAgICAgIGZvciAoY2FwID0gMDsgY2FwIDwgc2l6ZW9m
KCpod2NhcHMpICogQklUU19QRVJfQllURTsgY2FwKyspIHsNCj4gICAgICAgICAgICAgICAgIGlu
dCByZGlkeCwgcHBpZHg7DQo+IA0KPiBAQCAtMjY0Nyw3ICsyNzYwLDcgQEAgc3RhdGljIGludCBz
cGlfbm9yX2RlZmF1bHRfc2V0dXAoc3RydWN0IHNwaV9ub3IgKm5vciwNCj4gICAgICAgICAgICAg
ICAgICAqIGNvbnRyb2xsZXIgZGlyZWN0bHkgaW1wbGVtZW50cyB0aGUgc3BpX25vciBpbnRlcmZh
Y2UuDQo+ICAgICAgICAgICAgICAgICAgKiBZZXQgYW5vdGhlciByZWFzb24gdG8gc3dpdGNoIHRv
IHNwaS1tZW0uDQo+ICAgICAgICAgICAgICAgICAgKi8NCj4gLSAgICAgICAgICAgICAgIGlnbm9y
ZWRfbWFzayA9IFNOT1JfSFdDQVBTX1hfWF9YOw0KPiArICAgICAgICAgICAgICAgaWdub3JlZF9t
YXNrID0gU05PUl9IV0NBUFNfWF9YX1ggfCBTTk9SX0hXQ0FQU19YX1hfWF9EVFI7DQo+ICAgICAg
ICAgICAgICAgICBpZiAoc2hhcmVkX21hc2sgJiBpZ25vcmVkX21hc2spIHsNCj4gICAgICAgICAg
ICAgICAgICAgICAgICAgZGV2X2RiZyhub3ItPmRldiwNCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAiU1BJIG4tbi1uIHByb3RvY29scyBhcmUgbm90IHN1cHBvcnRlZC5cbiIpOw0K
PiBAQCAtMjc5MywxMSArMjkwNiwyOCBAQCBzdGF0aWMgdm9pZCBzcGlfbm9yX2luZm9faW5pdF9w
YXJhbXMoc3RydWN0IHNwaV9ub3IgKm5vcikNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgU05PUl9QUk9UT18xXzFfOCk7DQo+ICAgICAgICAgfQ0KPiANCj4gKyAg
ICAgICBpZiAoaW5mby0+ZmxhZ3MgJiBTUElfTk9SX09DVEFMX0RUUl9SRUFEKSB7DQo+ICsgICAg
ICAgICAgICAgICBwYXJhbXMtPmh3Y2Fwcy5tYXNrIHw9IFNOT1JfSFdDQVBTX1JFQURfOF84Xzhf
RFRSOw0KPiArICAgICAgICAgICAgICAgc3BpX25vcl9zZXRfcmVhZF9zZXR0aW5ncygmcGFyYW1z
LT5yZWFkc1tTTk9SX0NNRF9SRUFEXzhfOF84X0RUUl0sDQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIDAsIDIwLCBTUElOT1JfT1BfUkVBRF9GQVNULA0KPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTTk9SX1BST1RPXzhfOF84X0RU
Uik7DQo+ICsgICAgICAgfQ0KPiArDQo+ICAgICAgICAgLyogUGFnZSBQcm9ncmFtIHNldHRpbmdz
LiAqLw0KPiAgICAgICAgIHBhcmFtcy0+aHdjYXBzLm1hc2sgfD0gU05PUl9IV0NBUFNfUFA7DQo+
ICAgICAgICAgc3BpX25vcl9zZXRfcHBfc2V0dGluZ3MoJnBhcmFtcy0+cGFnZV9wcm9ncmFtc1tT
Tk9SX0NNRF9QUF0sDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJTk9SX09Q
X1BQLCBTTk9SX1BST1RPXzFfMV8xKTsNCj4gDQo+ICsgICAgICAgaWYgKGluZm8tPmZsYWdzICYg
U1BJX05PUl9PQ1RBTF9EVFJfUFApIHsNCj4gKyAgICAgICAgICAgICAgIHBhcmFtcy0+aHdjYXBz
Lm1hc2sgfD0gU05PUl9IV0NBUFNfUFBfOF84XzhfRFRSOw0KPiArICAgICAgICAgICAgICAgLyoN
Cj4gKyAgICAgICAgICAgICAgICAqIFNpbmNlIHhTUEkgUGFnZSBQcm9ncmFtIG9wY29kZSBpcyBi
YWNrd2FyZCBjb21wYXRpYmxlIHdpdGgNCj4gKyAgICAgICAgICAgICAgICAqIExlZ2FjeSBTUEks
IHVzZSBMZWdhY3kgU1BJIG9wY29kZSB0aGVyZSBhcyB3ZWxsLg0KPiArICAgICAgICAgICAgICAg
ICovDQo+ICsgICAgICAgICAgICAgICBzcGlfbm9yX3NldF9wcF9zZXR0aW5ncygmcGFyYW1zLT5w
YWdlX3Byb2dyYW1zW1NOT1JfQ01EX1BQXzhfOF84X0RUUl0sDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBTUElOT1JfT1BfUFAsIFNOT1JfUFJPVE9fOF84XzhfRFRS
KTsNCj4gKyAgICAgICB9DQo+ICsNCj4gICAgICAgICAvKg0KPiAgICAgICAgICAqIFNlY3RvciBF
cmFzZSBzZXR0aW5ncy4gU29ydCBFcmFzZSBUeXBlcyBpbiBhc2NlbmRpbmcgb3JkZXIsIHdpdGgg
dGhlDQo+ICAgICAgICAgICogc21hbGxlc3QgZXJhc2Ugc2l6ZSBzdGFydGluZyBhdCBCSVQoMCku
DQo+IEBAIC0yOTA1LDcgKzMwMzUsOCBAQCBzdGF0aWMgaW50IHNwaV9ub3JfaW5pdF9wYXJhbXMo
c3RydWN0IHNwaV9ub3IgKm5vcikNCj4gDQo+ICAgICAgICAgc3BpX25vcl9tYW51ZmFjdHVyZXJf
aW5pdF9wYXJhbXMobm9yKTsNCj4gDQo+IC0gICAgICAgaWYgKChub3ItPmluZm8tPmZsYWdzICYg
KFNQSV9OT1JfRFVBTF9SRUFEIHwgU1BJX05PUl9RVUFEX1JFQUQpKSAmJg0KPiArICAgICAgIGlm
ICgobm9yLT5pbmZvLT5mbGFncyAmIChTUElfTk9SX0RVQUxfUkVBRCB8IFNQSV9OT1JfUVVBRF9S
RUFEIHwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX05PUl9PQ1RBTF9S
RUFEIHwgU1BJX05PUl9PQ1RBTF9EVFJfUkVBRCkpICYmDQo+ICAgICAgICAgICAgICEobm9yLT5p
bmZvLT5mbGFncyAmIFNQSV9OT1JfU0tJUF9TRkRQKSkNCj4gICAgICAgICAgICAgICAgIHNwaV9u
b3Jfc2ZkcF9pbml0X3BhcmFtcyhub3IpOw0KPiANCj4gQEAgLTI5NjcsNyArMzA5OCw5IEBAIHN0
YXRpYyBpbnQgc3BpX25vcl9pbml0KHN0cnVjdCBzcGlfbm9yICpub3IpDQo+ICAgICAgICAgICAg
ICAgICByZXR1cm4gZXJyOw0KPiAgICAgICAgIH0NCj4gDQo+IC0gICAgICAgaWYgKG5vci0+YWRk
cl93aWR0aCA9PSA0ICYmICEobm9yLT5mbGFncyAmIFNOT1JfRl80Ql9PUENPREVTKSkgew0KPiAr
ICAgICAgIGlmIChub3ItPmFkZHJfd2lkdGggPT0gNCAmJg0KPiArICAgICAgICAgICBub3ItPnJl
YWRfcHJvdG8gIT0gU05PUl9QUk9UT184XzhfOF9EVFIgJiYNCj4gKyAgICAgICAgICAgIShub3It
PmZsYWdzICYgU05PUl9GXzRCX09QQ09ERVMpKSB7DQo+ICAgICAgICAgICAgICAgICAvKg0KPiAg
ICAgICAgICAgICAgICAgICogSWYgdGhlIFJFU0VUIyBwaW4gaXNuJ3QgaG9va2VkIHVwIHByb3Bl
cmx5LCBvciB0aGUgc3lzdGVtDQo+ICAgICAgICAgICAgICAgICAgKiBvdGhlcndpc2UgZG9lc24n
dCBwZXJmb3JtIGEgcmVzZXQgY29tbWFuZCBpbiB0aGUgYm9vdA0KPiBAQCAtMzAyNCw3ICszMTU3
LDIxIEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZmxhc2hfaW5mbyAqc3BpX25vcl9tYXRjaF9pZChz
dHJ1Y3Qgc3BpX25vciAqbm9yLA0KPiANCj4gIHN0YXRpYyBpbnQgc3BpX25vcl9zZXRfYWRkcl93
aWR0aChzdHJ1Y3Qgc3BpX25vciAqbm9yKQ0KPiAgew0KPiAtICAgICAgIGlmIChub3ItPmFkZHJf
d2lkdGgpIHsNCj4gKyAgICAgICBpZiAobm9yLT5yZWFkX3Byb3RvID09IFNOT1JfUFJPVE9fOF84
XzhfRFRSKSB7DQoNClRoaXMgc2hvdWxkIGNvbWUgYXMgYW4gImVsc2UgaWYiLiBXZSBuZWVkIHRv
IGxldCB0aGUgcG9zaWJpbGl0eSB0byByZXRyaWV2ZQ0KYWRkcl93aWR0aCBmcm9tIFNGRFAsIHRo
ZSBzdGFuZGFyZCBrbm93cyBiZXR0ZXIgdGhhbiB1cy4NCg0KV2l0aCB0aGVzZSBhZGRyZXNzZWQs
IG9uZSBjYW4gYWRkOg0KDQpSZXZpZXdlZC1ieTogVHVkb3IgQW1iYXJ1cyA8dHVkb3IuYW1iYXJ1
c0BtaWNyb2NoaXAuY29tPg0KDQo+ICsgICAgICAgICAgICAgICAvKg0KPiArICAgICAgICAgICAg
ICAgICogSW4gOEQtOEQtOEQgbW9kZSwgb25lIGJ5dGUgdGFrZXMgaGFsZiBhIGN5Y2xlIHRvIHRy
YW5zZmVyLiBTbw0KPiArICAgICAgICAgICAgICAgICogaW4gdGhpcyBwcm90b2NvbCBhbiBvZGQg
YWRkcmVzcyB3aWR0aCBjYW5ub3QgYmUgdXNlZCBiZWNhdXNlDQo+ICsgICAgICAgICAgICAgICAg
KiB0aGVuIHRoZSBhZGRyZXNzIHBoYXNlIHdvdWxkIG9ubHkgc3BhbiBhIGN5Y2xlIGFuZCBhIGhh
bGYuDQo+ICsgICAgICAgICAgICAgICAgKiBIYWxmIGEgY3ljbGUgd291bGQgYmUgbGVmdCBvdmVy
LiBXZSB3b3VsZCB0aGVuIGhhdmUgdG8gc3RhcnQNCj4gKyAgICAgICAgICAgICAgICAqIHRoZSBk
dW1teSBwaGFzZSBpbiB0aGUgbWlkZGxlIG9mIGEgY3ljbGUgYW5kIHNvIHRvbyB0aGUgZGF0YQ0K
PiArICAgICAgICAgICAgICAgICogcGhhc2UsIGFuZCB3ZSB3aWxsIGVuZCB0aGUgdHJhbnNhY3Rp
b24gd2l0aCBoYWxmIGEgY3ljbGUgbGVmdA0KPiArICAgICAgICAgICAgICAgICogb3Zlci4NCj4g
KyAgICAgICAgICAgICAgICAqDQo+ICsgICAgICAgICAgICAgICAgKiBGb3JjZSBhbGwgOEQtOEQt
OEQgZmxhc2hlcyB0byB1c2UgYW4gYWRkcmVzcyB3aWR0aCBvZiA0IHRvDQo+ICsgICAgICAgICAg
ICAgICAgKiBhdm9pZCB0aGlzIHNpdHVhdGlvbi4NCj4gKyAgICAgICAgICAgICAgICAqLw0KPiAr
ICAgICAgICAgICAgICAgbm9yLT5hZGRyX3dpZHRoID0gNDsNCj4gKyAgICAgICB9IGVsc2UgaWYg
KG5vci0+YWRkcl93aWR0aCkgew0KPiAgICAgICAgICAgICAgICAgLyogYWxyZWFkeSBjb25maWd1
cmVkIGZyb20gU0ZEUCAqLw0KPiAgICAgICAgIH0gZWxzZSBpZiAobm9yLT5pbmZvLT5hZGRyX3dp
ZHRoKSB7DQo+ICAgICAgICAgICAgICAgICBub3ItPmFkZHJfd2lkdGggPSBub3ItPmluZm8tPmFk
ZHJfd2lkdGg7DQo+IEBAIC0zMjU0LDIzICszNDAxLDI4IEBAIEVYUE9SVF9TWU1CT0xfR1BMKHNw
aV9ub3Jfc2Nhbik7DQo+ICBzdGF0aWMgaW50IHNwaV9ub3JfY3JlYXRlX3JlYWRfZGlybWFwKHN0
cnVjdCBzcGlfbm9yICpub3IpDQo+ICB7DQo+ICAgICAgICAgc3RydWN0IHNwaV9tZW1fZGlybWFw
X2luZm8gaW5mbyA9IHsNCj4gLSAgICAgICAgICAgICAgIC5vcF90bXBsID0gU1BJX01FTV9PUChT
UElfTUVNX09QX0NNRChub3ItPnJlYWRfb3Bjb2RlLCAxKSwNCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0FERFIobm9yLT5hZGRyX3dpZHRoLCAwLCAx
KSwNCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0RV
TU1ZKG5vci0+cmVhZF9kdW1teSwgMSksDQo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgU1BJX01FTV9PUF9EQVRBX0lOKDAsIE5VTEwsIDEpKSwNCj4gKyAgICAgICAgICAg
ICAgIC5vcF90bXBsID0gU1BJX01FTV9PUChTUElfTUVNX09QX0NNRChub3ItPnJlYWRfb3Bjb2Rl
LCAwKSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09Q
X0FERFIobm9yLT5hZGRyX3dpZHRoLCAwLCAwKSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBTUElfTUVNX09QX0RVTU1ZKG5vci0+cmVhZF9kdW1teSwgMCksDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BJX01FTV9PUF9EQVRBX0lOKDAs
IE5VTEwsIDApKSwNCj4gICAgICAgICAgICAgICAgIC5vZmZzZXQgPSAwLA0KPiAgICAgICAgICAg
ICAgICAgLmxlbmd0aCA9IG5vci0+bXRkLnNpemUsDQo+ICAgICAgICAgfTsNCj4gICAgICAgICBz
dHJ1Y3Qgc3BpX21lbV9vcCAqb3AgPSAmaW5mby5vcF90bXBsOw0KPiANCj4gLSAgICAgICAvKiBn
ZXQgdHJhbnNmZXIgcHJvdG9jb2xzLiAqLw0KPiAtICAgICAgIG9wLT5jbWQuYnVzd2lkdGggPSBz
cGlfbm9yX2dldF9wcm90b2NvbF9pbnN0X25iaXRzKG5vci0+cmVhZF9wcm90byk7DQo+IC0gICAg
ICAgb3AtPmFkZHIuYnVzd2lkdGggPSBzcGlfbm9yX2dldF9wcm90b2NvbF9hZGRyX25iaXRzKG5v
ci0+cmVhZF9wcm90byk7DQo+IC0gICAgICAgb3AtPmR1bW15LmJ1c3dpZHRoID0gb3AtPmFkZHIu
YnVzd2lkdGg7DQo+IC0gICAgICAgb3AtPmRhdGEuYnVzd2lkdGggPSBzcGlfbm9yX2dldF9wcm90
b2NvbF9kYXRhX25iaXRzKG5vci0+cmVhZF9wcm90byk7DQo+ICsgICAgICAgc3BpX25vcl9zcGlt
ZW1fc2V0dXBfb3Aobm9yLCBvcCwgbm9yLT5yZWFkX3Byb3RvKTsNCj4gDQo+ICAgICAgICAgLyog
Y29udmVydCB0aGUgZHVtbXkgY3ljbGVzIHRvIHRoZSBudW1iZXIgb2YgYnl0ZXMgKi8NCj4gICAg
ICAgICBvcC0+ZHVtbXkubmJ5dGVzID0gKG5vci0+cmVhZF9kdW1teSAqIG9wLT5kdW1teS5idXN3
aWR0aCkgLyA4Ow0KPiArICAgICAgIGlmIChzcGlfbm9yX3Byb3RvY29sX2lzX2R0cihub3ItPnJl
YWRfcHJvdG8pKQ0KPiArICAgICAgICAgICAgICAgb3AtPmR1bW15Lm5ieXRlcyAqPSAyOw0KPiAr
DQo+ICsgICAgICAgLyoNCj4gKyAgICAgICAgKiBTaW5jZSBzcGlfbm9yX3NwaW1lbV9zZXR1cF9v
cCgpIG9ubHkgc2V0cyBidXN3aWR0aCB3aGVuIHRoZSBudW1iZXINCj4gKyAgICAgICAgKiBvZiBk
YXRhIGJ5dGVzIGlzIG5vbi16ZXJvLCB0aGUgZGF0YSBidXN3aWR0aCB3b24ndCBiZSBzZXQgaGVy
ZS4gU28sDQo+ICsgICAgICAgICogZG8gaXQgZXhwbGljaXRseS4NCj4gKyAgICAgICAgKi8NCj4g
KyAgICAgICBvcC0+ZGF0YS5idXN3aWR0aCA9IHNwaV9ub3JfZ2V0X3Byb3RvY29sX2RhdGFfbmJp
dHMobm9yLT5yZWFkX3Byb3RvKTsNCj4gDQo+ICAgICAgICAgbm9yLT5kaXJtYXAucmRlc2MgPSBk
ZXZtX3NwaV9tZW1fZGlybWFwX2NyZWF0ZShub3ItPmRldiwgbm9yLT5zcGltZW0sDQo+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmaW5mbyk7
DQo+IEBAIC0zMjgwLDI0ICszNDMyLDI3IEBAIHN0YXRpYyBpbnQgc3BpX25vcl9jcmVhdGVfcmVh
ZF9kaXJtYXAoc3RydWN0IHNwaV9ub3IgKm5vcikNCj4gIHN0YXRpYyBpbnQgc3BpX25vcl9jcmVh
dGVfd3JpdGVfZGlybWFwKHN0cnVjdCBzcGlfbm9yICpub3IpDQo+ICB7DQo+ICAgICAgICAgc3Ry
dWN0IHNwaV9tZW1fZGlybWFwX2luZm8gaW5mbyA9IHsNCj4gLSAgICAgICAgICAgICAgIC5vcF90
bXBsID0gU1BJX01FTV9PUChTUElfTUVNX09QX0NNRChub3ItPnByb2dyYW1fb3Bjb2RlLCAxKSwN
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0FERFIo
bm9yLT5hZGRyX3dpZHRoLCAwLCAxKSwNCj4gKyAgICAgICAgICAgICAgIC5vcF90bXBsID0gU1BJ
X01FTV9PUChTUElfTUVNX09QX0NNRChub3ItPnByb2dyYW1fb3Bjb2RlLCAwKSwNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElfTUVNX09QX0FERFIobm9yLT5hZGRy
X3dpZHRoLCAwLCAwKSwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBT
UElfTUVNX09QX05PX0RVTU1ZLA0KPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFNQSV9NRU1fT1BfREFUQV9PVVQoMCwgTlVMTCwgMSkpLA0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFNQSV9NRU1fT1BfREFUQV9PVVQoMCwgTlVMTCwgMCkpLA0K
PiAgICAgICAgICAgICAgICAgLm9mZnNldCA9IDAsDQo+ICAgICAgICAgICAgICAgICAubGVuZ3Ro
ID0gbm9yLT5tdGQuc2l6ZSwNCj4gICAgICAgICB9Ow0KPiAgICAgICAgIHN0cnVjdCBzcGlfbWVt
X29wICpvcCA9ICZpbmZvLm9wX3RtcGw7DQo+IA0KPiAtICAgICAgIC8qIGdldCB0cmFuc2ZlciBw
cm90b2NvbHMuICovDQo+IC0gICAgICAgb3AtPmNtZC5idXN3aWR0aCA9IHNwaV9ub3JfZ2V0X3By
b3RvY29sX2luc3RfbmJpdHMobm9yLT53cml0ZV9wcm90byk7DQo+IC0gICAgICAgb3AtPmFkZHIu
YnVzd2lkdGggPSBzcGlfbm9yX2dldF9wcm90b2NvbF9hZGRyX25iaXRzKG5vci0+d3JpdGVfcHJv
dG8pOw0KPiAtICAgICAgIG9wLT5kdW1teS5idXN3aWR0aCA9IG9wLT5hZGRyLmJ1c3dpZHRoOw0K
PiAtICAgICAgIG9wLT5kYXRhLmJ1c3dpZHRoID0gc3BpX25vcl9nZXRfcHJvdG9jb2xfZGF0YV9u
Yml0cyhub3ItPndyaXRlX3Byb3RvKTsNCj4gLQ0KPiAgICAgICAgIGlmIChub3ItPnByb2dyYW1f
b3Bjb2RlID09IFNQSU5PUl9PUF9BQUlfV1AgJiYgbm9yLT5zc3Rfd3JpdGVfc2Vjb25kKQ0KPiAg
ICAgICAgICAgICAgICAgb3AtPmFkZHIubmJ5dGVzID0gMDsNCj4gDQo+ICsgICAgICAgc3BpX25v
cl9zcGltZW1fc2V0dXBfb3Aobm9yLCBvcCwgbm9yLT53cml0ZV9wcm90byk7DQo+ICsNCj4gKyAg
ICAgICAvKg0KPiArICAgICAgICAqIFNpbmNlIHNwaV9ub3Jfc3BpbWVtX3NldHVwX29wKCkgb25s
eSBzZXRzIGJ1c3dpZHRoIHdoZW4gdGhlIG51bWJlcg0KPiArICAgICAgICAqIG9mIGRhdGEgYnl0
ZXMgaXMgbm9uLXplcm8sIHRoZSBkYXRhIGJ1c3dpZHRoIHdvbid0IGJlIHNldCBoZXJlLiBTbywN
Cj4gKyAgICAgICAgKiBkbyBpdCBleHBsaWNpdGx5Lg0KPiArICAgICAgICAqLw0KPiArICAgICAg
IG9wLT5kYXRhLmJ1c3dpZHRoID0gc3BpX25vcl9nZXRfcHJvdG9jb2xfZGF0YV9uYml0cyhub3It
PndyaXRlX3Byb3RvKTsNCj4gKw0KPiAgICAgICAgIG5vci0+ZGlybWFwLndkZXNjID0gZGV2bV9z
cGlfbWVtX2Rpcm1hcF9jcmVhdGUobm9yLT5kZXYsIG5vci0+c3BpbWVtLA0KPiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmluZm8pOw0KPiAg
ICAgICAgIHJldHVybiBQVFJfRVJSX09SX1pFUk8obm9yLT5kaXJtYXAud2Rlc2MpOw0KPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9tdGQvc3BpLW5vci9jb3JlLmggYi9kcml2ZXJzL210ZC9zcGktbm9y
L2NvcmUuaA0KPiBpbmRleCA2ZjJmNmIyNzE3M2YuLjVkOTViNDE4M2EzMyAxMDA2NDQNCj4gLS0t
IGEvZHJpdmVycy9tdGQvc3BpLW5vci9jb3JlLmgNCj4gKysrIGIvZHJpdmVycy9tdGQvc3BpLW5v
ci9jb3JlLmgNCj4gQEAgLTYyLDYgKzYyLDcgQEAgZW51bSBzcGlfbm9yX3JlYWRfY29tbWFuZF9p
bmRleCB7DQo+ICAgICAgICAgU05PUl9DTURfUkVBRF8xXzhfOCwNCj4gICAgICAgICBTTk9SX0NN
RF9SRUFEXzhfOF84LA0KPiAgICAgICAgIFNOT1JfQ01EX1JFQURfMV84XzhfRFRSLA0KPiArICAg
ICAgIFNOT1JfQ01EX1JFQURfOF84XzhfRFRSLA0KPiANCj4gICAgICAgICBTTk9SX0NNRF9SRUFE
X01BWA0KPiAgfTsNCj4gQEAgLTc4LDYgKzc5LDcgQEAgZW51bSBzcGlfbm9yX3BwX2NvbW1hbmRf
aW5kZXggew0KPiAgICAgICAgIFNOT1JfQ01EX1BQXzFfMV84LA0KPiAgICAgICAgIFNOT1JfQ01E
X1BQXzFfOF84LA0KPiAgICAgICAgIFNOT1JfQ01EX1BQXzhfOF84LA0KPiArICAgICAgIFNOT1Jf
Q01EX1BQXzhfOF84X0RUUiwNCj4gDQo+ICAgICAgICAgU05PUl9DTURfUFBfTUFYDQo+ICB9Ow0K
PiBAQCAtMzExLDYgKzMxMyw4IEBAIHN0cnVjdCBmbGFzaF9pbmZvIHsNCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEJQMyBpcyBiaXQgNiBvZiBzdGF0dXMgcmVn
aXN0ZXIuDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBNdXN0
IGJlIHVzZWQgd2l0aCBTUElfTk9SXzRCSVRfQlAuDQo+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgKi8NCj4gKyNkZWZpbmUgU1BJX05PUl9PQ1RBTF9EVFJfUkVBRCBC
SVQoMTkpIC8qIEZsYXNoIHN1cHBvcnRzIG9jdGFsIERUUiBSZWFkLiAqLw0KPiArI2RlZmluZSBT
UElfTk9SX09DVEFMX0RUUl9QUCAgIEJJVCgyMCkgLyogRmxhc2ggc3VwcG9ydHMgT2N0YWwgRFRS
IFBhZ2UgUHJvZ3JhbSAqLw0KPiANCj4gICAgICAgICAvKiBQYXJ0IHNwZWNpZmljIGZpeHVwIGhv
b2tzLiAqLw0KPiAgICAgICAgIGNvbnN0IHN0cnVjdCBzcGlfbm9yX2ZpeHVwcyAqZml4dXBzOw0K
PiBAQCAtMzk5LDYgKzQwMyw5IEBAIGV4dGVybiBjb25zdCBzdHJ1Y3Qgc3BpX25vcl9tYW51ZmFj
dHVyZXIgc3BpX25vcl93aW5ib25kOw0KPiAgZXh0ZXJuIGNvbnN0IHN0cnVjdCBzcGlfbm9yX21h
bnVmYWN0dXJlciBzcGlfbm9yX3hpbGlueDsNCj4gIGV4dGVybiBjb25zdCBzdHJ1Y3Qgc3BpX25v
cl9tYW51ZmFjdHVyZXIgc3BpX25vcl94bWM7DQo+IA0KPiArdm9pZCBzcGlfbm9yX3NwaW1lbV9z
ZXR1cF9vcChjb25zdCBzdHJ1Y3Qgc3BpX25vciAqbm9yLA0KPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBzcGlfbWVtX29wICpvcCwNCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBjb25zdCBlbnVtIHNwaV9ub3JfcHJvdG9jb2wgcHJvdG8pOw0KPiAgaW50IHNwaV9u
b3Jfd3JpdGVfZW5hYmxlKHN0cnVjdCBzcGlfbm9yICpub3IpOw0KPiAgaW50IHNwaV9ub3Jfd3Jp
dGVfZGlzYWJsZShzdHJ1Y3Qgc3BpX25vciAqbm9yKTsNCj4gIGludCBzcGlfbm9yX3NldF80Ynl0
ZV9hZGRyX21vZGUoc3RydWN0IHNwaV9ub3IgKm5vciwgYm9vbCBlbmFibGUpOw0KPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9tdGQvc3BpLW5vci9zZmRwLmMgYi9kcml2ZXJzL210ZC9zcGktbm9yL3Nm
ZHAuYw0KPiBpbmRleCBlMmE0M2QzOWViNWYuLjIxZmE5YWI3OGVhZSAxMDA2NDQNCj4gLS0tIGEv
ZHJpdmVycy9tdGQvc3BpLW5vci9zZmRwLmMNCj4gKysrIGIvZHJpdmVycy9tdGQvc3BpLW5vci9z
ZmRwLmMNCj4gQEAgLTEwNDcsOSArMTA0NywxNiBAQCBzdGF0aWMgaW50IHNwaV9ub3JfcGFyc2Vf
NGJhaXQoc3RydWN0IHNwaV9ub3IgKm5vciwNCj4gICAgICAgICB9DQo+IA0KPiAgICAgICAgIC8q
IDRCQUlUIGlzIHRoZSBvbmx5IFNGRFAgdGFibGUgdGhhdCBpbmRpY2F0ZXMgcGFnZSBwcm9ncmFt
IHN1cHBvcnQuICovDQo+IC0gICAgICAgaWYgKHBwX2h3Y2FwcyAmIFNOT1JfSFdDQVBTX1BQKQ0K
PiArICAgICAgIGlmIChwcF9od2NhcHMgJiBTTk9SX0hXQ0FQU19QUCkgew0KPiAgICAgICAgICAg
ICAgICAgc3BpX25vcl9zZXRfcHBfc2V0dGluZ3MoJnBhcmFtc19wcFtTTk9SX0NNRF9QUF0sDQo+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElOT1JfT1BfUFBfNEIs
IFNOT1JfUFJPVE9fMV8xXzEpOw0KPiArICAgICAgICAgICAgICAgLyoNCj4gKyAgICAgICAgICAg
ICAgICAqIFNpbmNlIHhTUEkgUGFnZSBQcm9ncmFtIG9wY29kZSBpcyBiYWNrd2FyZCBjb21wYXRp
YmxlIHdpdGgNCj4gKyAgICAgICAgICAgICAgICAqIExlZ2FjeSBTUEksIHVzZSBMZWdhY3kgU1BJ
IG9wY29kZSB0aGVyZSBhcyB3ZWxsLg0KPiArICAgICAgICAgICAgICAgICovDQo+ICsgICAgICAg
ICAgICAgICBzcGlfbm9yX3NldF9wcF9zZXR0aW5ncygmcGFyYW1zX3BwW1NOT1JfQ01EX1BQXzhf
OF84X0RUUl0sDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElO
T1JfT1BfUFBfNEIsIFNOT1JfUFJPVE9fOF84XzhfRFRSKTsNCj4gKyAgICAgICB9DQo+ICAgICAg
ICAgaWYgKHBwX2h3Y2FwcyAmIFNOT1JfSFdDQVBTX1BQXzFfMV80KQ0KPiAgICAgICAgICAgICAg
ICAgc3BpX25vcl9zZXRfcHBfc2V0dGluZ3MoJnBhcmFtc19wcFtTTk9SX0NNRF9QUF8xXzFfNF0s
DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUElOT1JfT1BfUFBf
MV8xXzRfNEIsDQo+IGRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L210ZC9zcGktbm9yLmggYi9p
bmNsdWRlL2xpbnV4L210ZC9zcGktbm9yLmgNCj4gaW5kZXggNjBiYWMyYzBlYzQ1Li5jZDU0OTA0
MmM1M2QgMTAwNjQ0DQo+IC0tLSBhL2luY2x1ZGUvbGludXgvbXRkL3NwaS1ub3IuaA0KPiArKysg
Yi9pbmNsdWRlL2xpbnV4L210ZC9zcGktbm9yLmgNCj4gQEAgLTE4Miw2ICsxODIsNyBAQCBlbnVt
IHNwaV9ub3JfcHJvdG9jb2wgew0KPiAgICAgICAgIFNOT1JfUFJPVE9fMV8yXzJfRFRSID0gU05P
Ul9QUk9UT19EVFIoMSwgMiwgMiksDQo+ICAgICAgICAgU05PUl9QUk9UT18xXzRfNF9EVFIgPSBT
Tk9SX1BST1RPX0RUUigxLCA0LCA0KSwNCj4gICAgICAgICBTTk9SX1BST1RPXzFfOF84X0RUUiA9
IFNOT1JfUFJPVE9fRFRSKDEsIDgsIDgpLA0KPiArICAgICAgIFNOT1JfUFJPVE9fOF84XzhfRFRS
ID0gU05PUl9QUk9UT19EVFIoOCwgOCwgOCksDQo+ICB9Ow0KPiANCj4gIHN0YXRpYyBpbmxpbmUg
Ym9vbCBzcGlfbm9yX3Byb3RvY29sX2lzX2R0cihlbnVtIHNwaV9ub3JfcHJvdG9jb2wgcHJvdG8p
DQo+IEBAIC0yMjgsNyArMjI5LDcgQEAgc3RydWN0IHNwaV9ub3JfaHdjYXBzIHsNCj4gICAqIHRo
ZW4gUXVhZCBTUEkgcHJvdG9jb2xzIGJlZm9yZSBEdWFsIFNQSSBwcm90b2NvbHMsIEZhc3QgUmVh
ZCBhbmQgbGFzdGx5DQo+ICAgKiAoU2xvdykgUmVhZC4NCj4gICAqLw0KPiAtI2RlZmluZSBTTk9S
X0hXQ0FQU19SRUFEX01BU0sgICAgICAgICAgR0VOTUFTSygxNCwgMCkNCj4gKyNkZWZpbmUgU05P
Ul9IV0NBUFNfUkVBRF9NQVNLICAgICAgICAgIEdFTk1BU0soMTUsIDApDQo+ICAjZGVmaW5lIFNO
T1JfSFdDQVBTX1JFQUQgICAgICAgICAgICAgICBCSVQoMCkNCj4gICNkZWZpbmUgU05PUl9IV0NB
UFNfUkVBRF9GQVNUICAgICAgICAgIEJJVCgxKQ0KPiAgI2RlZmluZSBTTk9SX0hXQ0FQU19SRUFE
XzFfMV8xX0RUUiAgICAgQklUKDIpDQo+IEBAIC0yNDUsMTEgKzI0NiwxMiBAQCBzdHJ1Y3Qgc3Bp
X25vcl9od2NhcHMgew0KPiAgI2RlZmluZSBTTk9SX0hXQ0FQU19SRUFEXzRfNF80ICAgICAgICAg
QklUKDkpDQo+ICAjZGVmaW5lIFNOT1JfSFdDQVBTX1JFQURfMV80XzRfRFRSICAgICBCSVQoMTAp
DQo+IA0KPiAtI2RlZmluZSBTTk9SX0hXQ0FQU19SRUFEX09DVEFMICAgICAgICAgR0VOTUFTSygx
NCwgMTEpDQo+ICsjZGVmaW5lIFNOT1JfSFdDQVBTX1JFQURfT0NUQUwgICAgICAgICBHRU5NQVNL
KDE1LCAxMSkNCj4gICNkZWZpbmUgU05PUl9IV0NBUFNfUkVBRF8xXzFfOCAgICAgICAgIEJJVCgx
MSkNCj4gICNkZWZpbmUgU05PUl9IV0NBUFNfUkVBRF8xXzhfOCAgICAgICAgIEJJVCgxMikNCj4g
ICNkZWZpbmUgU05PUl9IV0NBUFNfUkVBRF84XzhfOCAgICAgICAgIEJJVCgxMykNCj4gICNkZWZp
bmUgU05PUl9IV0NBUFNfUkVBRF8xXzhfOF9EVFIgICAgIEJJVCgxNCkNCj4gKyNkZWZpbmUgU05P
Ul9IV0NBUFNfUkVBRF84XzhfOF9EVFIgICAgIEJJVCgxNSkNCj4gDQo+ICAvKg0KPiAgICogUGFn
ZSBQcm9ncmFtIGNhcGFiaWxpdGllcy4NCj4gQEAgLTI2MCwxOCArMjYyLDE5IEBAIHN0cnVjdCBz
cGlfbm9yX2h3Y2FwcyB7DQo+ICAgKiBKRURFQy9TRkRQIHN0YW5kYXJkIHRvIGRlZmluZSB0aGVt
LiBBbHNvIGF0IHRoaXMgbW9tZW50IG5vIFNQSSBmbGFzaCBtZW1vcnkNCj4gICAqIGltcGxlbWVu
dHMgc3VjaCBjb21tYW5kcy4NCj4gICAqLw0KPiAtI2RlZmluZSBTTk9SX0hXQ0FQU19QUF9NQVNL
ICAgIEdFTk1BU0soMjIsIDE2KQ0KPiAtI2RlZmluZSBTTk9SX0hXQ0FQU19QUCAgICAgICAgIEJJ
VCgxNikNCj4gKyNkZWZpbmUgU05PUl9IV0NBUFNfUFBfTUFTSyAgICAgICAgICAgIEdFTk1BU0so
MjMsIDE2KQ0KPiArI2RlZmluZSBTTk9SX0hXQ0FQU19QUCAgICAgICAgICAgICAgICAgQklUKDE2
KQ0KPiANCj4gLSNkZWZpbmUgU05PUl9IV0NBUFNfUFBfUVVBRCAgICBHRU5NQVNLKDE5LCAxNykN
Cj4gLSNkZWZpbmUgU05PUl9IV0NBUFNfUFBfMV8xXzQgICBCSVQoMTcpDQo+IC0jZGVmaW5lIFNO
T1JfSFdDQVBTX1BQXzFfNF80ICAgQklUKDE4KQ0KPiAtI2RlZmluZSBTTk9SX0hXQ0FQU19QUF80
XzRfNCAgIEJJVCgxOSkNCj4gKyNkZWZpbmUgU05PUl9IV0NBUFNfUFBfUVVBRCAgICAgICAgICAg
IEdFTk1BU0soMTksIDE3KQ0KPiArI2RlZmluZSBTTk9SX0hXQ0FQU19QUF8xXzFfNCAgICAgICAg
ICAgQklUKDE3KQ0KPiArI2RlZmluZSBTTk9SX0hXQ0FQU19QUF8xXzRfNCAgICAgICAgICAgQklU
KDE4KQ0KPiArI2RlZmluZSBTTk9SX0hXQ0FQU19QUF80XzRfNCAgICAgICAgICAgQklUKDE5KQ0K
PiANCj4gLSNkZWZpbmUgU05PUl9IV0NBUFNfUFBfT0NUQUwgICBHRU5NQVNLKDIyLCAyMCkNCj4g
LSNkZWZpbmUgU05PUl9IV0NBUFNfUFBfMV8xXzggICBCSVQoMjApDQo+IC0jZGVmaW5lIFNOT1Jf
SFdDQVBTX1BQXzFfOF84ICAgQklUKDIxKQ0KPiAtI2RlZmluZSBTTk9SX0hXQ0FQU19QUF84Xzhf
OCAgIEJJVCgyMikNCj4gKyNkZWZpbmUgU05PUl9IV0NBUFNfUFBfT0NUQUwgICAgICAgICAgIEdF
Tk1BU0soMjMsIDIwKQ0KPiArI2RlZmluZSBTTk9SX0hXQ0FQU19QUF8xXzFfOCAgICAgICAgICAg
QklUKDIwKQ0KPiArI2RlZmluZSBTTk9SX0hXQ0FQU19QUF8xXzhfOCAgICAgICAgICAgQklUKDIx
KQ0KPiArI2RlZmluZSBTTk9SX0hXQ0FQU19QUF84XzhfOCAgICAgICAgICAgQklUKDIyKQ0KPiAr
I2RlZmluZSBTTk9SX0hXQ0FQU19QUF84XzhfOF9EVFIgICAgICAgQklUKDIzKQ0KPiANCj4gICNk
ZWZpbmUgU05PUl9IV0NBUFNfWF9YX1ggICAgICAoU05PUl9IV0NBUFNfUkVBRF8yXzJfMiB8ICAg
ICAgIFwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU05PUl9IV0NBUFNfUkVB
RF80XzRfNCB8ICAgICAgIFwNCj4gQEAgLTI3OSwxMCArMjgyLDE0IEBAIHN0cnVjdCBzcGlfbm9y
X2h3Y2FwcyB7DQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNOT1JfSFdDQVBT
X1BQXzRfNF80IHwgICAgICAgICBcDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFNOT1JfSFdDQVBTX1BQXzhfOF84KQ0KPiANCj4gKyNkZWZpbmUgU05PUl9IV0NBUFNfWF9YX1hf
RFRSICAoU05PUl9IV0NBUFNfUkVBRF84XzhfOF9EVFIgfCAgIFwNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgU05PUl9IV0NBUFNfUFBfOF84XzhfRFRSKQ0KPiArDQo+ICAjZGVm
aW5lIFNOT1JfSFdDQVBTX0RUUiAgICAgICAgICAgICAgICAoU05PUl9IV0NBUFNfUkVBRF8xXzFf
MV9EVFIgfCAgIFwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU05PUl9IV0NB
UFNfUkVBRF8xXzJfMl9EVFIgfCAgIFwNCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgU05PUl9IV0NBUFNfUkVBRF8xXzRfNF9EVFIgfCAgIFwNCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgU05PUl9IV0NBUFNfUkVBRF8xXzhfOF9EVFIpDQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFNOT1JfSFdDQVBTX1JFQURfMV84XzhfRFRSIHwgICBcDQo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNOT1JfSFdDQVBTX1JFQURfOF84Xzhf
RFRSKQ0KPiANCj4gICNkZWZpbmUgU05PUl9IV0NBUFNfQUxMICAgICAgICAgICAgICAgIChTTk9S
X0hXQ0FQU19SRUFEX01BU0sgfCAgICAgICAgXA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBTTk9SX0hXQ0FQU19QUF9NQVNLKQ0KPiBAQCAtMzE4LDYgKzMyNSwyMiBAQCBzdHJ1
Y3Qgc3BpX25vcl9jb250cm9sbGVyX29wcyB7DQo+ICAgICAgICAgaW50ICgqZXJhc2UpKHN0cnVj
dCBzcGlfbm9yICpub3IsIGxvZmZfdCBvZmZzKTsNCj4gIH07DQo+IA0KPiArLyoqDQo+ICsgKiBl
bnVtIHNwaV9ub3JfY21kX2V4dCAtIGRlc2NyaWJlcyB0aGUgY29tbWFuZCBvcGNvZGUgZXh0ZW5z
aW9uIGluIERUUiBtb2RlDQo+ICsgKiBAU1BJX05PUl9FWFRfTk9ORTogbm8gZXh0ZW5zaW9uLiBU
aGlzIGlzIHRoZSBkZWZhdWx0LCBhbmQgaXMgdXNlZCBpbiBMZWdhY3kNCj4gKyAqICAgICAgICAg
ICAgICAgICAgIFNQSSBtb2RlDQo+ICsgKiBAU1BJX05PUl9FWFRfUkVQRUFUOiB0aGUgZXh0ZW5z
aW9uIGlzIHNhbWUgYXMgdGhlIG9wY29kZQ0KPiArICogQFNQSV9OT1JfRVhUX0lOVkVSVDogdGhl
IGV4dGVuc2lvbiBpcyB0aGUgYml0d2lzZSBpbnZlcnNlIG9mIHRoZSBvcGNvZGUNCj4gKyAqIEBT
UElfTk9SX0VYVF9IRVg6IHRoZSBleHRlbnNpb24gaXMgYW55IGhleCB2YWx1ZS4gVGhlIGNvbW1h
bmQgYW5kIG9wY29kZQ0KPiArICogICAgICAgICAgICAgICAgICBjb21iaW5lIHRvIGZvcm0gYSAx
Ni1iaXQgb3Bjb2RlLg0KPiArICovDQo+ICtlbnVtIHNwaV9ub3JfY21kX2V4dCB7DQo+ICsgICAg
ICAgU1BJX05PUl9FWFRfTk9ORSA9IDAsDQo+ICsgICAgICAgU1BJX05PUl9FWFRfUkVQRUFULA0K
PiArICAgICAgIFNQSV9OT1JfRVhUX0lOVkVSVCwNCj4gKyAgICAgICBTUElfTk9SX0VYVF9IRVgs
DQo+ICt9Ow0KPiArDQo+ICAvKg0KPiAgICogRm9yd2FyZCBkZWNsYXJhdGlvbnMgdGhhdCBhcmUg
dXNlZCBpbnRlcm5hbGx5IGJ5IHRoZSBjb3JlIGFuZCBtYW51ZmFjdHVyZXINCj4gICAqIGRyaXZl
cnMuDQo+IEBAIC0zNDUsNiArMzY4LDcgQEAgc3RydWN0IHNwaV9ub3JfZmxhc2hfcGFyYW1ldGVy
Ow0KPiAgICogQHByb2dyYW1fb3Bjb2RlOiAgICB0aGUgcHJvZ3JhbSBvcGNvZGUNCj4gICAqIEBz
c3Rfd3JpdGVfc2Vjb25kOiAgdXNlZCBieSB0aGUgU1NUIHdyaXRlIG9wZXJhdGlvbg0KPiAgICog
QGZsYWdzOiAgICAgICAgICAgICBmbGFnIG9wdGlvbnMgZm9yIHRoZSBjdXJyZW50IFNQSSBOT1Ig
KFNOT1JfRl8qKQ0KPiArICogQGNtZF9leHRfdHlwZTogICAgICB0aGUgY29tbWFuZCBvcGNvZGUg
ZXh0ZW5zaW9uIHR5cGUgZm9yIERUUiBtb2RlLg0KPiAgICogQHJlYWRfcHJvdG86ICAgICAgICAg
ICAgICAgIHRoZSBTUEkgcHJvdG9jb2wgZm9yIHJlYWQgb3BlcmF0aW9ucw0KPiAgICogQHdyaXRl
X3Byb3RvOiAgICAgICB0aGUgU1BJIHByb3RvY29sIGZvciB3cml0ZSBvcGVyYXRpb25zDQo+ICAg
KiBAcmVnX3Byb3RvOiAgICAgICAgIHRoZSBTUEkgcHJvdG9jb2wgZm9yIHJlYWRfcmVnL3dyaXRl
X3JlZy9lcmFzZSBvcGVyYXRpb25zDQo+IEBAIC0zNzYsNiArNDAwLDcgQEAgc3RydWN0IHNwaV9u
b3Igew0KPiAgICAgICAgIGVudW0gc3BpX25vcl9wcm90b2NvbCAgIHJlZ19wcm90bzsNCj4gICAg
ICAgICBib29sICAgICAgICAgICAgICAgICAgICBzc3Rfd3JpdGVfc2Vjb25kOw0KPiAgICAgICAg
IHUzMiAgICAgICAgICAgICAgICAgICAgIGZsYWdzOw0KPiArICAgICAgIGVudW0gc3BpX25vcl9j
bWRfZXh0ICAgIGNtZF9leHRfdHlwZTsNCj4gDQo+ICAgICAgICAgY29uc3Qgc3RydWN0IHNwaV9u
b3JfY29udHJvbGxlcl9vcHMgKmNvbnRyb2xsZXJfb3BzOw0KPiANCj4gLS0NCj4gMi4yOC4wDQo+
IA0KDQo=
